<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Electrochemical Cell Charger/Discharger/Tester: charger_discharger.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Electrochemical Cell Charger/Discharger/Tester
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">charger_discharger.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>State machine header file for Charge and Discharge System.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;xc.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
</div>
<p><a href="charger__discharger_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a024148e99a7143db044a48216664d03d"><td class="memItemLeft" align="right" valign="top"><a id="a024148e99a7143db044a48216664d03d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a024148e99a7143db044a48216664d03d">_XTAL_FREQ</a>&#160;&#160;&#160;32000000</td></tr>
<tr class="memdesc:a024148e99a7143db044a48216664d03d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frequency to coordinate delays, 32 MHz. <br /></td></tr>
<tr class="separator:a024148e99a7143db044a48216664d03d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadc49366a240cc84254d58cb455dee82"><td class="memItemLeft" align="right" valign="top"><a id="aadc49366a240cc84254d58cb455dee82"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#aadc49366a240cc84254d58cb455dee82">ERR_MAX</a>&#160;&#160;&#160;250</td></tr>
<tr class="memdesc:aadc49366a240cc84254d58cb455dee82"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum permisible error, useful to avoid ringing. <br /></td></tr>
<tr class="separator:aadc49366a240cc84254d58cb455dee82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bcad3156af59109b8ac2c78c588885a"><td class="memItemLeft" align="right" valign="top"><a id="a5bcad3156af59109b8ac2c78c588885a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a5bcad3156af59109b8ac2c78c588885a">ERR_MIN</a>&#160;&#160;&#160;-250</td></tr>
<tr class="memdesc:a5bcad3156af59109b8ac2c78c588885a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Minimum permisible error, useful to avoid ringing. <br /></td></tr>
<tr class="separator:a5bcad3156af59109b8ac2c78c588885a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a420d619b855e71d5e8d4c26e2d0a0461"><td class="memItemLeft" align="right" valign="top"><a id="a420d619b855e71d5e8d4c26e2d0a0461"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a420d619b855e71d5e8d4c26e2d0a0461">V_CHAN</a>&#160;&#160;&#160;0b01101</td></tr>
<tr class="memdesc:a420d619b855e71d5e8d4c26e2d0a0461"><td class="mdescLeft">&#160;</td><td class="mdescRight">Definition of ADC channel for voltage measurements. AN13(RB5) <br /></td></tr>
<tr class="separator:a420d619b855e71d5e8d4c26e2d0a0461"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72da0b033e023b574cca6ab663e25fca"><td class="memItemLeft" align="right" valign="top"><a id="a72da0b033e023b574cca6ab663e25fca"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a72da0b033e023b574cca6ab663e25fca">I_CHAN</a>&#160;&#160;&#160;0b01011</td></tr>
<tr class="memdesc:a72da0b033e023b574cca6ab663e25fca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Definition of ADC channel for current measurements. AN11(RB4) <br /></td></tr>
<tr class="separator:a72da0b033e023b574cca6ab663e25fca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10ddb4ca8b21ecdf02ab19d67cb9142c"><td class="memItemLeft" align="right" valign="top"><a id="a10ddb4ca8b21ecdf02ab19d67cb9142c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a10ddb4ca8b21ecdf02ab19d67cb9142c">T_CHAN</a>&#160;&#160;&#160;0b01100</td></tr>
<tr class="memdesc:a10ddb4ca8b21ecdf02ab19d67cb9142c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Definition of ADC channel for temperature measurements. AN12(RB0) <br /></td></tr>
<tr class="separator:a10ddb4ca8b21ecdf02ab19d67cb9142c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0eaf54b864a26d51679cbcc7f3322cf9"><td class="memItemLeft" align="right" valign="top"><a id="a0eaf54b864a26d51679cbcc7f3322cf9"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a0eaf54b864a26d51679cbcc7f3322cf9">CELL1_ON</a>&#160;&#160;&#160;PORTAbits.RA7 = 1</td></tr>
<tr class="memdesc:a0eaf54b864a26d51679cbcc7f3322cf9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Turn on Cell #1. <br /></td></tr>
<tr class="separator:a0eaf54b864a26d51679cbcc7f3322cf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b4e6e0b7adb4da774ac20fbff00a893"><td class="memItemLeft" align="right" valign="top"><a id="a9b4e6e0b7adb4da774ac20fbff00a893"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a9b4e6e0b7adb4da774ac20fbff00a893">CELL2_ON</a>&#160;&#160;&#160;PORTAbits.RA6 = 1</td></tr>
<tr class="memdesc:a9b4e6e0b7adb4da774ac20fbff00a893"><td class="mdescLeft">&#160;</td><td class="mdescRight">Turn on Cell #2. <br /></td></tr>
<tr class="separator:a9b4e6e0b7adb4da774ac20fbff00a893"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a7eac4ae4b673e22527ed52c3a84ccd"><td class="memItemLeft" align="right" valign="top"><a id="a4a7eac4ae4b673e22527ed52c3a84ccd"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a4a7eac4ae4b673e22527ed52c3a84ccd">CELL3_ON</a>&#160;&#160;&#160;PORTCbits.RC0 = 1</td></tr>
<tr class="memdesc:a4a7eac4ae4b673e22527ed52c3a84ccd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Turn on Cell #3. <br /></td></tr>
<tr class="separator:a4a7eac4ae4b673e22527ed52c3a84ccd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72e53e946d76a85cccfb0da40cb52ed4"><td class="memItemLeft" align="right" valign="top"><a id="a72e53e946d76a85cccfb0da40cb52ed4"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a72e53e946d76a85cccfb0da40cb52ed4">CELL4_ON</a>&#160;&#160;&#160;PORTCbits.RC1 = 1</td></tr>
<tr class="memdesc:a72e53e946d76a85cccfb0da40cb52ed4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Turn on Cell #4. <br /></td></tr>
<tr class="separator:a72e53e946d76a85cccfb0da40cb52ed4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a129e4ca70087ef40f75cb1a262eedccb"><td class="memItemLeft" align="right" valign="top"><a id="a129e4ca70087ef40f75cb1a262eedccb"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a129e4ca70087ef40f75cb1a262eedccb">CELL1_OFF</a>&#160;&#160;&#160;PORTAbits.RA7 = 0</td></tr>
<tr class="memdesc:a129e4ca70087ef40f75cb1a262eedccb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Turn off Cell #1. <br /></td></tr>
<tr class="separator:a129e4ca70087ef40f75cb1a262eedccb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1579988c69eff7ad877b1bd2a339cfb"><td class="memItemLeft" align="right" valign="top"><a id="ac1579988c69eff7ad877b1bd2a339cfb"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#ac1579988c69eff7ad877b1bd2a339cfb">CELL2_OFF</a>&#160;&#160;&#160;PORTAbits.RA6 = 0</td></tr>
<tr class="memdesc:ac1579988c69eff7ad877b1bd2a339cfb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Turn off Cell #2. <br /></td></tr>
<tr class="separator:ac1579988c69eff7ad877b1bd2a339cfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a517a98dd71380fed753c3514a61be6fd"><td class="memItemLeft" align="right" valign="top"><a id="a517a98dd71380fed753c3514a61be6fd"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a517a98dd71380fed753c3514a61be6fd">CELL3_OFF</a>&#160;&#160;&#160;PORTCbits.RC0 = 0</td></tr>
<tr class="memdesc:a517a98dd71380fed753c3514a61be6fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Turn off Cell #3. <br /></td></tr>
<tr class="separator:a517a98dd71380fed753c3514a61be6fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa926591f10e87bb1273848225e6b316c"><td class="memItemLeft" align="right" valign="top"><a id="aa926591f10e87bb1273848225e6b316c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#aa926591f10e87bb1273848225e6b316c">CELL4_OFF</a>&#160;&#160;&#160;PORTCbits.RC1 = 0</td></tr>
<tr class="memdesc:aa926591f10e87bb1273848225e6b316c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Turn off Cell #4. <br /></td></tr>
<tr class="separator:aa926591f10e87bb1273848225e6b316c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a450cfb6cea2848f3c6459ed5c0df9eef"><td class="memItemLeft" align="right" valign="top"><a id="a450cfb6cea2848f3c6459ed5c0df9eef"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a450cfb6cea2848f3c6459ed5c0df9eef">AD_SET_CHAN</a>(x)&#160;&#160;&#160;{ ADCON0bits.CHS = x; __delay_us(1); }</td></tr>
<tr class="memdesc:a450cfb6cea2848f3c6459ed5c0df9eef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the ADC channel to <code>x</code> and wait for 5 microseconds. <br /></td></tr>
<tr class="separator:a450cfb6cea2848f3c6459ed5c0df9eef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57f8ee4c55d0b9230535c602e01dbbdc"><td class="memItemLeft" align="right" valign="top"><a id="a57f8ee4c55d0b9230535c602e01dbbdc"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a57f8ee4c55d0b9230535c602e01dbbdc">AD_CONVERT</a>()&#160;&#160;&#160;{ GO_nDONE = 1; while(GO_nDONE);}</td></tr>
<tr class="memdesc:a57f8ee4c55d0b9230535c602e01dbbdc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start the conversion and wait until it is finished. <br /></td></tr>
<tr class="separator:a57f8ee4c55d0b9230535c602e01dbbdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a049dca77d5e2be6f3780ce6a632a5ef3"><td class="memItemLeft" align="right" valign="top"><a id="a049dca77d5e2be6f3780ce6a632a5ef3"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a049dca77d5e2be6f3780ce6a632a5ef3">AD_RESULT</a>()&#160;&#160;&#160;{ <a class="el" href="charger__discharger_8h.html#a02303eca810feb8092be2ff939a714c3">ad_res</a> = 0; <a class="el" href="charger__discharger_8h.html#a02303eca810feb8092be2ff939a714c3">ad_res</a> = (ADRESL &amp; 0xFF)|((ADRESH &lt;&lt; 8) &amp; 0xF00);}</td></tr>
<tr class="memdesc:a049dca77d5e2be6f3780ce6a632a5ef3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Store conversion result in <a class="el" href="charger__discharger_8h.html#a02303eca810feb8092be2ff939a714c3" title="Result of an ADC measurement. ">ad_res</a>. <br /></td></tr>
<tr class="separator:a049dca77d5e2be6f3780ce6a632a5ef3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1cb4a0872e924cf862a97b33dd2edf0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#ae1cb4a0872e924cf862a97b33dd2edf0">STOP_CONVERTER</a>()&#160;&#160;&#160;{ <a class="el" href="charger__discharger_8h.html#a0cc5d179fc4afa584f15244b35b01521">conv</a> = 0; RA1 = 1; <a class="el" href="charger__discharger_8h.html#a7feaae074885a9d2f57a75e0809ee4ba">dc</a> = <a class="el" href="charger__discharger_8h.html#a998e4507851dde706a60a5b475eb27ca">DC_MIN</a>; <a class="el" href="charger__discharger_8h.html#a93f3630c962d9bcafd71e4c4a03547c1">set_DC</a>(); <a class="el" href="charger__discharger_8h.html#a5bbc85db8cf08142e0984d07b97e722b">Cell_OFF</a>(); <a class="el" href="charger__discharger_8h.html#a2f57a3156036b713dc852737da390252">LOG_OFF</a>();}</td></tr>
<tr class="memdesc:ae1cb4a0872e924cf862a97b33dd2edf0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stop the converter.  <a href="#ae1cb4a0872e924cf862a97b33dd2edf0">More...</a><br /></td></tr>
<tr class="separator:ae1cb4a0872e924cf862a97b33dd2edf0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acda4f577829f9d4ff58b9636903cbfe0"><td class="memItemLeft" align="right" valign="top"><a id="acda4f577829f9d4ff58b9636903cbfe0"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#acda4f577829f9d4ff58b9636903cbfe0">UART_INT_ON</a>()&#160;&#160;&#160;{ while(RCIF) <a class="el" href="charger__discharger_8h.html#a2ac955a54afa8f9039b93a3f30b04acd">clear</a> = RC1REG; RCIE = 1; }</td></tr>
<tr class="memdesc:acda4f577829f9d4ff58b9636903cbfe0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear transmission buffer and turn ON UART transmission interrupts. <br /></td></tr>
<tr class="separator:acda4f577829f9d4ff58b9636903cbfe0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d26e5ca6078be961b6b42719ebca269"><td class="memItemLeft" align="right" valign="top"><a id="a4d26e5ca6078be961b6b42719ebca269"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a4d26e5ca6078be961b6b42719ebca269">LOG_ON</a>()&#160;&#160;&#160;{ <a class="el" href="charger__discharger_8h.html#a8c9205727cab72e65f536e9ef6445db0">log_on</a> = 1; }</td></tr>
<tr class="memdesc:a4d26e5ca6078be961b6b42719ebca269"><td class="mdescLeft">&#160;</td><td class="mdescRight">Turn OFF logging in the terminal. <br /></td></tr>
<tr class="separator:a4d26e5ca6078be961b6b42719ebca269"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f57a3156036b713dc852737da390252"><td class="memItemLeft" align="right" valign="top"><a id="a2f57a3156036b713dc852737da390252"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a2f57a3156036b713dc852737da390252">LOG_OFF</a>()&#160;&#160;&#160;{ <a class="el" href="charger__discharger_8h.html#a8c9205727cab72e65f536e9ef6445db0">log_on</a> = 0; }</td></tr>
<tr class="memdesc:a2f57a3156036b713dc852737da390252"><td class="mdescLeft">&#160;</td><td class="mdescRight">Turn ON logging in the terminal. <br /></td></tr>
<tr class="separator:a2f57a3156036b713dc852737da390252"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59595b0c67a8bfb8dd65e914a18b83c7"><td class="memItemLeft" align="right" valign="top"><a id="a59595b0c67a8bfb8dd65e914a18b83c7"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a59595b0c67a8bfb8dd65e914a18b83c7">RESET_TIME</a>()&#160;&#160;&#160;{ <a class="el" href="charger__discharger_8h.html#a5edffad982a0566ad01d95005474eae3">minute</a> = 0; <a class="el" href="charger__discharger_8h.html#a6cf35be1947a62f134392fcb1b3c54d2">second</a> = -1; }</td></tr>
<tr class="memdesc:a59595b0c67a8bfb8dd65e914a18b83c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset timers. <br /></td></tr>
<tr class="separator:a59595b0c67a8bfb8dd65e914a18b83c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a998e4507851dde706a60a5b475eb27ca"><td class="memItemLeft" align="right" valign="top"><a id="a998e4507851dde706a60a5b475eb27ca"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a998e4507851dde706a60a5b475eb27ca">DC_MIN</a>&#160;&#160;&#160;25</td></tr>
<tr class="memdesc:a998e4507851dde706a60a5b475eb27ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Minimum possible duty cycle, set around <b>0.05</b>. <br /></td></tr>
<tr class="separator:a998e4507851dde706a60a5b475eb27ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa845f7768f44631f4b54b9cde4dc2b2f"><td class="memItemLeft" align="right" valign="top"><a id="aa845f7768f44631f4b54b9cde4dc2b2f"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#aa845f7768f44631f4b54b9cde4dc2b2f">DC_START</a>&#160;&#160;&#160;51</td></tr>
<tr class="memdesc:aa845f7768f44631f4b54b9cde4dc2b2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initial duty cycle, set around <b>0.1</b>. <br /></td></tr>
<tr class="separator:aa845f7768f44631f4b54b9cde4dc2b2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a701d2222601b84faafa94cb1909df104"><td class="memItemLeft" align="right" valign="top"><a id="a701d2222601b84faafa94cb1909df104"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a701d2222601b84faafa94cb1909df104">DC_MAX</a>&#160;&#160;&#160;385</td></tr>
<tr class="memdesc:a701d2222601b84faafa94cb1909df104"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum possible duty cycle, set around <b>0.8</b>. <br /></td></tr>
<tr class="separator:a701d2222601b84faafa94cb1909df104"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7194053a42881b1b4bc8546b4c8713e9"><td class="memItemLeft" align="right" valign="top"><a id="a7194053a42881b1b4bc8546b4c8713e9"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a7194053a42881b1b4bc8546b4c8713e9">COUNTER</a>&#160;&#160;&#160;250</td></tr>
<tr class="memdesc:a7194053a42881b1b4bc8546b4c8713e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Counter value, needed to obtained one second between counts. <br /></td></tr>
<tr class="separator:a7194053a42881b1b4bc8546b4c8713e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07e4b1149c8a3d5d22e1d62cf1ac21a8"><td class="memItemLeft" align="right" valign="top"><a id="a07e4b1149c8a3d5d22e1d62cf1ac21a8"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a07e4b1149c8a3d5d22e1d62cf1ac21a8">CC_kp</a>&#160;&#160;&#160;0.025</td></tr>
<tr class="memdesc:a07e4b1149c8a3d5d22e1d62cf1ac21a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Proportional constant for CC mode. <br /></td></tr>
<tr class="separator:a07e4b1149c8a3d5d22e1d62cf1ac21a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82116df58bb08a3ea67109a434b9bd25"><td class="memItemLeft" align="right" valign="top"><a id="a82116df58bb08a3ea67109a434b9bd25"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a82116df58bb08a3ea67109a434b9bd25">CC_ki</a>&#160;&#160;&#160;0.04</td></tr>
<tr class="memdesc:a82116df58bb08a3ea67109a434b9bd25"><td class="mdescLeft">&#160;</td><td class="mdescRight">Integral constant for CC mode. <br /></td></tr>
<tr class="separator:a82116df58bb08a3ea67109a434b9bd25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31ae8362bae13f23cc6b521a7499a5ee"><td class="memItemLeft" align="right" valign="top"><a id="a31ae8362bae13f23cc6b521a7499a5ee"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a31ae8362bae13f23cc6b521a7499a5ee">CV_kp</a>&#160;&#160;&#160;0.4</td></tr>
<tr class="memdesc:a31ae8362bae13f23cc6b521a7499a5ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Proportional constant for CV mode. <br /></td></tr>
<tr class="separator:a31ae8362bae13f23cc6b521a7499a5ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57181200f8247c552f8d9751003d77c6"><td class="memItemLeft" align="right" valign="top"><a id="a57181200f8247c552f8d9751003d77c6"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a57181200f8247c552f8d9751003d77c6">CV_ki</a>&#160;&#160;&#160;0.5</td></tr>
<tr class="memdesc:a57181200f8247c552f8d9751003d77c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Integral constant for CV mode. <br /></td></tr>
<tr class="separator:a57181200f8247c552f8d9751003d77c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0597ae89918183de03119186d8995e75"><td class="memItemLeft" align="right" valign="top"><a id="a0597ae89918183de03119186d8995e75"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a0597ae89918183de03119186d8995e75">LINEBREAK</a>&#160;&#160;&#160;{ <a class="el" href="charger__discharger_8h.html#abf92d1a230db7234bdf5119716a0cf5f">UART_send_char</a>(10); }</td></tr>
<tr class="memdesc:a0597ae89918183de03119186d8995e75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send a linebreak to the terminal. <br /></td></tr>
<tr class="separator:a0597ae89918183de03119186d8995e75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28a6dfc4597c4f82e81b47ca06486504"><td class="memItemLeft" align="right" valign="top"><a id="a28a6dfc4597c4f82e81b47ca06486504"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a28a6dfc4597c4f82e81b47ca06486504">LI_ION_CHEM</a>&#160;&#160;&#160;0</td></tr>
<tr class="memdesc:a28a6dfc4597c4f82e81b47ca06486504"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set this definition to 1 and NI_MH_CHEM to 0 to set the test Li-Ion cells. <br /></td></tr>
<tr class="separator:a28a6dfc4597c4f82e81b47ca06486504"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80362a7f4e241d7fd6bcc19d5f21ffd7"><td class="memItemLeft" align="right" valign="top"><a id="a80362a7f4e241d7fd6bcc19d5f21ffd7"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a80362a7f4e241d7fd6bcc19d5f21ffd7">NI_MH_CHEM</a>&#160;&#160;&#160;1</td></tr>
<tr class="memdesc:a80362a7f4e241d7fd6bcc19d5f21ffd7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set this definition to 1 and LI_ION_CHEM to 0 to set the test Ni-MH cells. <br /></td></tr>
<tr class="separator:a80362a7f4e241d7fd6bcc19d5f21ffd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7676cdfa371dfdcf6fb0687737c29a6"><td class="memItemLeft" align="right" valign="top"><a id="ae7676cdfa371dfdcf6fb0687737c29a6"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#ae7676cdfa371dfdcf6fb0687737c29a6">WAIT_TIME</a>&#160;&#160;&#160;600</td></tr>
<tr class="memdesc:ae7676cdfa371dfdcf6fb0687737c29a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Time to wait before states, set to 10 minutes. <br /></td></tr>
<tr class="separator:ae7676cdfa371dfdcf6fb0687737c29a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2683ee4bd7cd9cdab8006368da6df09"><td class="memItemLeft" align="right" valign="top"><a id="aa2683ee4bd7cd9cdab8006368da6df09"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#aa2683ee4bd7cd9cdab8006368da6df09">DC_RES_SECS</a>&#160;&#160;&#160;14</td></tr>
<tr class="memdesc:aa2683ee4bd7cd9cdab8006368da6df09"><td class="mdescLeft">&#160;</td><td class="mdescRight">How many seconds the DC resistance process takes. <br /></td></tr>
<tr class="separator:aa2683ee4bd7cd9cdab8006368da6df09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d26458814361e1cf732df92f7dbc2d9"><td class="memItemLeft" align="right" valign="top"><a id="a5d26458814361e1cf732df92f7dbc2d9"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a5d26458814361e1cf732df92f7dbc2d9">Li_Ion_CV</a>&#160;&#160;&#160;4200</td></tr>
<tr class="memdesc:a5d26458814361e1cf732df92f7dbc2d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Li-Ion constant voltage setting in mV. <br /></td></tr>
<tr class="separator:a5d26458814361e1cf732df92f7dbc2d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb28139964ea13e391208ea07372cace"><td class="memItemLeft" align="right" valign="top"><a id="adb28139964ea13e391208ea07372cace"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#adb28139964ea13e391208ea07372cace">Li_Ion_CAP</a>&#160;&#160;&#160;3250</td></tr>
<tr class="memdesc:adb28139964ea13e391208ea07372cace"><td class="mdescLeft">&#160;</td><td class="mdescRight">Li-Ion capacity setting in mAh. <br /></td></tr>
<tr class="separator:adb28139964ea13e391208ea07372cace"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a613a15ecc1a8e85198d8c93ce546fcf6"><td class="memItemLeft" align="right" valign="top"><a id="a613a15ecc1a8e85198d8c93ce546fcf6"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a613a15ecc1a8e85198d8c93ce546fcf6">Li_Ion_EOC_I</a>&#160;&#160;&#160;100</td></tr>
<tr class="memdesc:a613a15ecc1a8e85198d8c93ce546fcf6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Li-Ion end-of-charge current in mA. <br /></td></tr>
<tr class="separator:a613a15ecc1a8e85198d8c93ce546fcf6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b5d74511caec60eedfdfbf9fe71ce94"><td class="memItemLeft" align="right" valign="top"><a id="a5b5d74511caec60eedfdfbf9fe71ce94"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a5b5d74511caec60eedfdfbf9fe71ce94">Li_Ion_EOD_V</a>&#160;&#160;&#160;3000</td></tr>
<tr class="memdesc:a5b5d74511caec60eedfdfbf9fe71ce94"><td class="mdescLeft">&#160;</td><td class="mdescRight">Li_Ion end-of-discharge voltage in mV. <br /></td></tr>
<tr class="separator:a5b5d74511caec60eedfdfbf9fe71ce94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8b7523ae7285838d22d268d244e3e41"><td class="memItemLeft" align="right" valign="top"><a id="ac8b7523ae7285838d22d268d244e3e41"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#ac8b7523ae7285838d22d268d244e3e41">Ni_MH_CV</a>&#160;&#160;&#160;1700</td></tr>
<tr class="memdesc:ac8b7523ae7285838d22d268d244e3e41"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ni-MH constant voltage setting in mV. <br /></td></tr>
<tr class="separator:ac8b7523ae7285838d22d268d244e3e41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94e2a4926de4ad984b884e1ea882f06a"><td class="memItemLeft" align="right" valign="top"><a id="a94e2a4926de4ad984b884e1ea882f06a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a94e2a4926de4ad984b884e1ea882f06a">Ni_MH_CAP</a>&#160;&#160;&#160;2000</td></tr>
<tr class="memdesc:a94e2a4926de4ad984b884e1ea882f06a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ni-MH capacity setting in mAh. <br /></td></tr>
<tr class="separator:a94e2a4926de4ad984b884e1ea882f06a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0f8da57c2fb3c5701f9d5fe4685bcd8"><td class="memItemLeft" align="right" valign="top"><a id="ae0f8da57c2fb3c5701f9d5fe4685bcd8"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#ae0f8da57c2fb3c5701f9d5fe4685bcd8">Ni_MH_EOC_DV</a>&#160;&#160;&#160;10</td></tr>
<tr class="memdesc:ae0f8da57c2fb3c5701f9d5fe4685bcd8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ni-MH end-fo-charge voltage drop in mV. <br /></td></tr>
<tr class="separator:ae0f8da57c2fb3c5701f9d5fe4685bcd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42b65399d5bd123d6001f5a0cf3353e1"><td class="memItemLeft" align="right" valign="top"><a id="a42b65399d5bd123d6001f5a0cf3353e1"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a42b65399d5bd123d6001f5a0cf3353e1">Ni_MH_EOD_V</a>&#160;&#160;&#160;1000</td></tr>
<tr class="memdesc:a42b65399d5bd123d6001f5a0cf3353e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ni-MH end-of-discharge voltage in mV. <br /></td></tr>
<tr class="separator:a42b65399d5bd123d6001f5a0cf3353e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:aa19be6305a5a4485e1e70de70ed7d677"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677">states</a> { <br />
&#160;&#160;<a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677ae4634ae4352b512b38c5da9dc1610ca6">STANDBY</a> = 0, 
<a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677afd6a0e4343048b10646dd2976cc5ad18">IDLE</a> = 1, 
<a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677ab7f3a434cd7c576917ad58613673c571">FAULT</a> = 2, 
<a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677a2df4f4d04ec310a30dd8eaac64f883a2">ISDONE</a> = 3, 
<br />
&#160;&#160;<a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677a79a322ccb4b29b85b3cab52dbccefd17">WAIT</a> = 4, 
<a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677a95c89aa15e7cbe4ca2a03d955a4b067c">PREDISCHARGE</a> = 5, 
<a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677aea7debd6c1f7cf2d27b8774acac4109f">CHARGE</a> = 6, 
<a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677adfece03792e81dc232ae4f15fee2a423">DISCHARGE</a> = 7, 
<br />
&#160;&#160;<a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677a90827714b4165a402681b4ce4874e5f0">POSTCHARGE</a> = 8, 
<a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677a5d64f3582250fabf9443c93ca77ecf9c">DS_DC_res</a> = 9, 
<a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677a031d03f2aee61a88f34151e0b532df5b">CS_DC_res</a> = 10, 
<a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677a68bd1d9b6b5d032caefff13585f9d22b">PS_DC_res</a> = 11
<br />
 }</td></tr>
<tr class="separator:aa19be6305a5a4485e1e70de70ed7d677"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a617e0199133fdef0d3a3e6a4a4c39c7e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a617e0199133fdef0d3a3e6a4a4c39c7e">fSTANDBY</a> (void)</td></tr>
<tr class="memdesc:a617e0199133fdef0d3a3e6a4a4c39c7e"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function define the <a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677ae4634ae4352b512b38c5da9dc1610ca6" title="&quot;Stand by&quot; state, defined by function fSTANDBY() ">STANDBY</a> state of the state machine.  <a href="#a617e0199133fdef0d3a3e6a4a4c39c7e">More...</a><br /></td></tr>
<tr class="separator:a617e0199133fdef0d3a3e6a4a4c39c7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af14972c8bcddf306a0cc7f7f43a5e3c1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#af14972c8bcddf306a0cc7f7f43a5e3c1">fIDLE</a> (void)</td></tr>
<tr class="memdesc:af14972c8bcddf306a0cc7f7f43a5e3c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function define the IDLE state of the state machine.  <a href="#af14972c8bcddf306a0cc7f7f43a5e3c1">More...</a><br /></td></tr>
<tr class="separator:af14972c8bcddf306a0cc7f7f43a5e3c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c4e2b572b4dd0ba38a90c7721edf3d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a0c4e2b572b4dd0ba38a90c7721edf3d8">fCHARGE</a> (void)</td></tr>
<tr class="memdesc:a0c4e2b572b4dd0ba38a90c7721edf3d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function define the IDLE state of the state machine.  <a href="#a0c4e2b572b4dd0ba38a90c7721edf3d8">More...</a><br /></td></tr>
<tr class="separator:a0c4e2b572b4dd0ba38a90c7721edf3d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad25aed7556b1faba14a86a62f1dd4f89"><td class="memItemLeft" align="right" valign="top"><a id="ad25aed7556b1faba14a86a62f1dd4f89"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#ad25aed7556b1faba14a86a62f1dd4f89">fDISCHARGE</a> (void)</td></tr>
<tr class="memdesc:ad25aed7556b1faba14a86a62f1dd4f89"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function define the IDLE state of the state machine. <br /></td></tr>
<tr class="separator:ad25aed7556b1faba14a86a62f1dd4f89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b36b83531f2626d071ba3d1115ba83f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a0b36b83531f2626d071ba3d1115ba83f">fDC_res</a> (void)</td></tr>
<tr class="memdesc:a0b36b83531f2626d071ba3d1115ba83f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function define the IDLE state of the state machine.  <a href="#a0b36b83531f2626d071ba3d1115ba83f">More...</a><br /></td></tr>
<tr class="separator:a0b36b83531f2626d071ba3d1115ba83f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a621fb7a48066389e0889ad9f7413f6c9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a621fb7a48066389e0889ad9f7413f6c9">fWAIT</a> (void)</td></tr>
<tr class="memdesc:a621fb7a48066389e0889ad9f7413f6c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function define the IDLE state of the state machine.  <a href="#a621fb7a48066389e0889ad9f7413f6c9">More...</a><br /></td></tr>
<tr class="separator:a621fb7a48066389e0889ad9f7413f6c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f57fe99a95d5951b37346f2e592a033"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a6f57fe99a95d5951b37346f2e592a033">fISDONE</a> (void)</td></tr>
<tr class="memdesc:a6f57fe99a95d5951b37346f2e592a033"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is executed every time a whole test process for one cell is finished.  <a href="#a6f57fe99a95d5951b37346f2e592a033">More...</a><br /></td></tr>
<tr class="separator:a6f57fe99a95d5951b37346f2e592a033"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa309f5ae96bb5d30d1097731fc373f1f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#aa309f5ae96bb5d30d1097731fc373f1f">fFAULT</a> (void)</td></tr>
<tr class="memdesc:aa309f5ae96bb5d30d1097731fc373f1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function define the FAULT state of the state machine.  <a href="#aa309f5ae96bb5d30d1097731fc373f1f">More...</a><br /></td></tr>
<tr class="separator:aa309f5ae96bb5d30d1097731fc373f1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa37d23c2482420861e3f4580cfbbdb2a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#aa37d23c2482420861e3f4580cfbbdb2a">start_state_machine</a> (void)</td></tr>
<tr class="memdesc:aa37d23c2482420861e3f4580cfbbdb2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to start the state machine.  <a href="#aa37d23c2482420861e3f4580cfbbdb2a">More...</a><br /></td></tr>
<tr class="separator:aa37d23c2482420861e3f4580cfbbdb2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b7665498c6c3419b3a6d53d4d2e25d9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a5b7665498c6c3419b3a6d53d4d2e25d9">state_machine</a> (void)</td></tr>
<tr class="memdesc:a5b7665498c6c3419b3a6d53d4d2e25d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function contain the transition definition for the states of the machine.  <a href="#a5b7665498c6c3419b3a6d53d4d2e25d9">More...</a><br /></td></tr>
<tr class="separator:a5b7665498c6c3419b3a6d53d4d2e25d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac441c35a0d7d01f983d6b3414944d62a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#ac441c35a0d7d01f983d6b3414944d62a">param</a> (void)</td></tr>
<tr class="memdesc:ac441c35a0d7d01f983d6b3414944d62a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to define the parameters of the testing process for both chemistries.  <a href="#ac441c35a0d7d01f983d6b3414944d62a">More...</a><br /></td></tr>
<tr class="separator:ac441c35a0d7d01f983d6b3414944d62a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a116216d02b45c1207161f503bf20adbc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a116216d02b45c1207161f503bf20adbc">converter_settings</a> (void)</td></tr>
<tr class="memdesc:a116216d02b45c1207161f503bf20adbc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to set the configurations of the converter.  <a href="#a116216d02b45c1207161f503bf20adbc">More...</a><br /></td></tr>
<tr class="separator:a116216d02b45c1207161f503bf20adbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9efe22aaead3a5e936b5df459de02eba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a9efe22aaead3a5e936b5df459de02eba">initialize</a> (void)</td></tr>
<tr class="memdesc:a9efe22aaead3a5e936b5df459de02eba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to define initialize the system.  <a href="#a9efe22aaead3a5e936b5df459de02eba">More...</a><br /></td></tr>
<tr class="separator:a9efe22aaead3a5e936b5df459de02eba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35df161adff36e572d40326f07d85d2b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a35df161adff36e572d40326f07d85d2b">pid</a> (float feedback, unsigned setpoint)</td></tr>
<tr class="memdesc:a35df161adff36e572d40326f07d85d2b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function defines the PI controller.  <a href="#a35df161adff36e572d40326f07d85d2b">More...</a><br /></td></tr>
<tr class="separator:a35df161adff36e572d40326f07d85d2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93f3630c962d9bcafd71e4c4a03547c1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a93f3630c962d9bcafd71e4c4a03547c1">set_DC</a> (void)</td></tr>
<tr class="memdesc:a93f3630c962d9bcafd71e4c4a03547c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function sets the desired duty cycle.  <a href="#a93f3630c962d9bcafd71e4c4a03547c1">More...</a><br /></td></tr>
<tr class="separator:a93f3630c962d9bcafd71e4c4a03547c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1402bbcb4580b6798483c7821e6106d2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a1402bbcb4580b6798483c7821e6106d2">read_ADC</a> (void)</td></tr>
<tr class="memdesc:a1402bbcb4580b6798483c7821e6106d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function read the ADC and store the data in the coresponding variables.  <a href="#a1402bbcb4580b6798483c7821e6106d2">More...</a><br /></td></tr>
<tr class="separator:a1402bbcb4580b6798483c7821e6106d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b8b498532d1d667c624601a3cf715bc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a0b8b498532d1d667c624601a3cf715bc">log_control</a> (void)</td></tr>
<tr class="memdesc:a0b8b498532d1d667c624601a3cf715bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function takes care of printing the test data using the UART.  <a href="#a0b8b498532d1d667c624601a3cf715bc">More...</a><br /></td></tr>
<tr class="separator:a0b8b498532d1d667c624601a3cf715bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4389e5f80fbf28788f2f648f26d93fce"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a4389e5f80fbf28788f2f648f26d93fce">display_value</a> (int value)</td></tr>
<tr class="memdesc:a4389e5f80fbf28788f2f648f26d93fce"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function convert a number to string and then send it using UART.  <a href="#a4389e5f80fbf28788f2f648f26d93fce">More...</a><br /></td></tr>
<tr class="separator:a4389e5f80fbf28788f2f648f26d93fce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ab308304942d68ad5733f1a0a9685a4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a9ab308304942d68ad5733f1a0a9685a4">cc_cv_mode</a> (float current_voltage, unsigned int reference_voltage, char CC_mode_status)</td></tr>
<tr class="memdesc:a9ab308304942d68ad5733f1a0a9685a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function switches between CC and CV mode.  <a href="#a9ab308304942d68ad5733f1a0a9685a4">More...</a><br /></td></tr>
<tr class="separator:a9ab308304942d68ad5733f1a0a9685a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f05187afaedd0cd35e9137eaf557ef8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a4f05187afaedd0cd35e9137eaf557ef8">control_loop</a> (void)</td></tr>
<tr class="memdesc:a4f05187afaedd0cd35e9137eaf557ef8"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is the PI control loop.  <a href="#a4f05187afaedd0cd35e9137eaf557ef8">More...</a><br /></td></tr>
<tr class="separator:a4f05187afaedd0cd35e9137eaf557ef8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2f580a1d85442504950b07e3c8f1145"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#ab2f580a1d85442504950b07e3c8f1145">calculate_avg</a> (void)</td></tr>
<tr class="memdesc:ab2f580a1d85442504950b07e3c8f1145"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function calculate the averages.  <a href="#ab2f580a1d85442504950b07e3c8f1145">More...</a><br /></td></tr>
<tr class="separator:ab2f580a1d85442504950b07e3c8f1145"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bcf31185383adefc22f2209541c9991"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a4bcf31185383adefc22f2209541c9991">UART_interrupt_enable</a> (void)</td></tr>
<tr class="memdesc:a4bcf31185383adefc22f2209541c9991"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function activate the UART reception interruption.  <a href="#a4bcf31185383adefc22f2209541c9991">More...</a><br /></td></tr>
<tr class="separator:a4bcf31185383adefc22f2209541c9991"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf92d1a230db7234bdf5119716a0cf5f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#abf92d1a230db7234bdf5119716a0cf5f">UART_send_char</a> (char bt)</td></tr>
<tr class="memdesc:abf92d1a230db7234bdf5119716a0cf5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function send one byte of data to UART.  <a href="#abf92d1a230db7234bdf5119716a0cf5f">More...</a><br /></td></tr>
<tr class="separator:abf92d1a230db7234bdf5119716a0cf5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae033bb8a9289af391aef3cc3bd57a0e9"><td class="memItemLeft" align="right" valign="top">char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#ae033bb8a9289af391aef3cc3bd57a0e9">UART_get_char</a> (void)</td></tr>
<tr class="memdesc:ae033bb8a9289af391aef3cc3bd57a0e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function receive one byte of data from UART.  <a href="#ae033bb8a9289af391aef3cc3bd57a0e9">More...</a><br /></td></tr>
<tr class="separator:ae033bb8a9289af391aef3cc3bd57a0e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac27ccd7f2eb1f5e96bb091338acc1e7f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#ac27ccd7f2eb1f5e96bb091338acc1e7f">UART_send_string</a> (char *st_pt)</td></tr>
<tr class="memdesc:ac27ccd7f2eb1f5e96bb091338acc1e7f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function send a string using UART.  <a href="#ac27ccd7f2eb1f5e96bb091338acc1e7f">More...</a><br /></td></tr>
<tr class="separator:ac27ccd7f2eb1f5e96bb091338acc1e7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75740b5600396316399a5608fe2cb4d3"><td class="memItemLeft" align="right" valign="top"><a id="a75740b5600396316399a5608fe2cb4d3"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a75740b5600396316399a5608fe2cb4d3">Cell_ON</a> (void)</td></tr>
<tr class="memdesc:a75740b5600396316399a5608fe2cb4d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function activate the desired relay in the switcher board according to the value of <a class="el" href="charger__discharger_8h.html#a2f582152bcd11169abaab8dfb2e0ae2a" title="Cell counter from &#39;1&#39; to &#39;4&#39;. Initialized as &#39;1&#39;. ">cell_count</a>. <br /></td></tr>
<tr class="separator:a75740b5600396316399a5608fe2cb4d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bbc85db8cf08142e0984d07b97e722b"><td class="memItemLeft" align="right" valign="top"><a id="a5bbc85db8cf08142e0984d07b97e722b"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a5bbc85db8cf08142e0984d07b97e722b">Cell_OFF</a> (void)</td></tr>
<tr class="memdesc:a5bbc85db8cf08142e0984d07b97e722b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function deactivate all relays in the switcher board. <br /></td></tr>
<tr class="separator:a5bbc85db8cf08142e0984d07b97e722b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2a34e3f615b83a0c9d721b76899b2a4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#ad2a34e3f615b83a0c9d721b76899b2a4">timing</a> (void)</td></tr>
<tr class="memdesc:ad2a34e3f615b83a0c9d721b76899b2a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function control the timing.  <a href="#ad2a34e3f615b83a0c9d721b76899b2a4">More...</a><br /></td></tr>
<tr class="separator:ad2a34e3f615b83a0c9d721b76899b2a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aa138b263667688f0a28af01c14f90f8a"><td class="memItemLeft" align="right" valign="top"><a id="aa138b263667688f0a28af01c14f90f8a"></a>
unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#aa138b263667688f0a28af01c14f90f8a">option</a> = 0</td></tr>
<tr class="memdesc:aa138b263667688f0a28af01c14f90f8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Four different options, look into <a class="el" href="charger__discharger_8h.html#ac441c35a0d7d01f983d6b3414944d62a">param()</a> for details. <br /></td></tr>
<tr class="separator:aa138b263667688f0a28af01c14f90f8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1bf8d3dc7c9a3ba66f0ee8e88885ca9"><td class="memItemLeft" align="right" valign="top"><a id="ab1bf8d3dc7c9a3ba66f0ee8e88885ca9"></a>
unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#ab1bf8d3dc7c9a3ba66f0ee8e88885ca9">capacity</a></td></tr>
<tr class="memdesc:ab1bf8d3dc7c9a3ba66f0ee8e88885ca9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Definition of capacity per cell according to each chemistry. <br /></td></tr>
<tr class="separator:ab1bf8d3dc7c9a3ba66f0ee8e88885ca9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f7bc04927df757f9416084659beb22b"><td class="memItemLeft" align="right" valign="top"><a id="a9f7bc04927df757f9416084659beb22b"></a>
unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a9f7bc04927df757f9416084659beb22b">i_char</a></td></tr>
<tr class="memdesc:a9f7bc04927df757f9416084659beb22b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Charging current in mA. <br /></td></tr>
<tr class="separator:a9f7bc04927df757f9416084659beb22b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abee5b899e99e0165d63f1e4a3b72a9dd"><td class="memItemLeft" align="right" valign="top"><a id="abee5b899e99e0165d63f1e4a3b72a9dd"></a>
unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#abee5b899e99e0165d63f1e4a3b72a9dd">i_disc</a></td></tr>
<tr class="memdesc:abee5b899e99e0165d63f1e4a3b72a9dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Discharging current in mA. <br /></td></tr>
<tr class="separator:abee5b899e99e0165d63f1e4a3b72a9dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f582152bcd11169abaab8dfb2e0ae2a"><td class="memItemLeft" align="right" valign="top"><a id="a2f582152bcd11169abaab8dfb2e0ae2a"></a>
unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a2f582152bcd11169abaab8dfb2e0ae2a">cell_count</a> = 49</td></tr>
<tr class="memdesc:a2f582152bcd11169abaab8dfb2e0ae2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cell counter from '1' to '4'. Initialized as '1'. <br /></td></tr>
<tr class="separator:a2f582152bcd11169abaab8dfb2e0ae2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00fd8f059b9286917da9abe7e3561aaa"><td class="memItemLeft" align="right" valign="top"><a id="a00fd8f059b9286917da9abe7e3561aaa"></a>
unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a00fd8f059b9286917da9abe7e3561aaa">cell_max</a> = 0</td></tr>
<tr class="memdesc:a00fd8f059b9286917da9abe7e3561aaa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of cells to be tested. Initialized as 0. <br /></td></tr>
<tr class="separator:a00fd8f059b9286917da9abe7e3561aaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6565850a0af535f87ce6e6fcb0b8c76"><td class="memItemLeft" align="right" valign="top"><a id="ab6565850a0af535f87ce6e6fcb0b8c76"></a>
unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#ab6565850a0af535f87ce6e6fcb0b8c76">wait_count</a> = <a class="el" href="charger__discharger_8h.html#ae7676cdfa371dfdcf6fb0687737c29a6">WAIT_TIME</a></td></tr>
<tr class="memdesc:ab6565850a0af535f87ce6e6fcb0b8c76"><td class="mdescLeft">&#160;</td><td class="mdescRight">Counter for waiting time between states. Initialized as <a class="el" href="charger__discharger_8h.html#ae7676cdfa371dfdcf6fb0687737c29a6">WAIT_TIME</a>. <br /></td></tr>
<tr class="separator:ab6565850a0af535f87ce6e6fcb0b8c76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84cf4389d019b53039c0c1ce35691335"><td class="memItemLeft" align="right" valign="top"><a id="a84cf4389d019b53039c0c1ce35691335"></a>
unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a84cf4389d019b53039c0c1ce35691335">dc_res_count</a> = <a class="el" href="charger__discharger_8h.html#aa2683ee4bd7cd9cdab8006368da6df09">DC_RES_SECS</a></td></tr>
<tr class="memdesc:a84cf4389d019b53039c0c1ce35691335"><td class="mdescLeft">&#160;</td><td class="mdescRight">Counter for DC resistance. Initialized as <a class="el" href="charger__discharger_8h.html#aa2683ee4bd7cd9cdab8006368da6df09">DC_RES_SECS</a>. <br /></td></tr>
<tr class="separator:a84cf4389d019b53039c0c1ce35691335"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab12828525693568ae9c217805bea1ef9"><td class="memItemLeft" align="right" valign="top"><a id="ab12828525693568ae9c217805bea1ef9"></a>
unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#ab12828525693568ae9c217805bea1ef9">state</a> = <a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677ae4634ae4352b512b38c5da9dc1610ca6">STANDBY</a></td></tr>
<tr class="memdesc:ab12828525693568ae9c217805bea1ef9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used with store the value of the <a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677">states</a> enum. Initialized as <a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677ae4634ae4352b512b38c5da9dc1610ca6">STANDBY</a>. <br /></td></tr>
<tr class="separator:ab12828525693568ae9c217805bea1ef9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad24a7209740a83b880691380fbe8e0e9"><td class="memItemLeft" align="right" valign="top"><a id="ad24a7209740a83b880691380fbe8e0e9"></a>
unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#ad24a7209740a83b880691380fbe8e0e9">prev_state</a> = <a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677ae4634ae4352b512b38c5da9dc1610ca6">STANDBY</a></td></tr>
<tr class="memdesc:ad24a7209740a83b880691380fbe8e0e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used to store the previous state. Initialized as <a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677ae4634ae4352b512b38c5da9dc1610ca6">STANDBY</a>. <br /></td></tr>
<tr class="separator:ad24a7209740a83b880691380fbe8e0e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d9cf26c168f75afbb7a381014693308"><td class="memItemLeft" align="right" valign="top"><a id="a0d9cf26c168f75afbb7a381014693308"></a>
unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a0d9cf26c168f75afbb7a381014693308">EOC_current</a></td></tr>
<tr class="memdesc:a0d9cf26c168f75afbb7a381014693308"><td class="mdescLeft">&#160;</td><td class="mdescRight">End-of-charge current in mA. <br /></td></tr>
<tr class="separator:a0d9cf26c168f75afbb7a381014693308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79e7b0a74f48e181c9d3505363eb5c3e"><td class="memItemLeft" align="right" valign="top"><a id="a79e7b0a74f48e181c9d3505363eb5c3e"></a>
unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a79e7b0a74f48e181c9d3505363eb5c3e">EOD_voltage</a></td></tr>
<tr class="memdesc:a79e7b0a74f48e181c9d3505363eb5c3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">End-of-dischage voltage in mV. <br /></td></tr>
<tr class="separator:a79e7b0a74f48e181c9d3505363eb5c3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a970f83c09721a0ee9345babbc60dfb1d"><td class="memItemLeft" align="right" valign="top"><a id="a970f83c09721a0ee9345babbc60dfb1d"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a970f83c09721a0ee9345babbc60dfb1d">v_1_dcres</a></td></tr>
<tr class="memdesc:a970f83c09721a0ee9345babbc60dfb1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">First voltage measured during DC resistance state. <br /></td></tr>
<tr class="separator:a970f83c09721a0ee9345babbc60dfb1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51e77c4807be0e46b1594a0263acaf36"><td class="memItemLeft" align="right" valign="top"><a id="a51e77c4807be0e46b1594a0263acaf36"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a51e77c4807be0e46b1594a0263acaf36">i_1_dcres</a></td></tr>
<tr class="memdesc:a51e77c4807be0e46b1594a0263acaf36"><td class="mdescLeft">&#160;</td><td class="mdescRight">First current measured during DC resistance state. <br /></td></tr>
<tr class="separator:a51e77c4807be0e46b1594a0263acaf36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32c077367b1758f5052389b73d9953fa"><td class="memItemLeft" align="right" valign="top"><a id="a32c077367b1758f5052389b73d9953fa"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a32c077367b1758f5052389b73d9953fa">v_2_dcres</a></td></tr>
<tr class="memdesc:a32c077367b1758f5052389b73d9953fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Second voltage measured during DC resistance state. <br /></td></tr>
<tr class="separator:a32c077367b1758f5052389b73d9953fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e61d5ae14f01d57c4b14204727ed8f8"><td class="memItemLeft" align="right" valign="top"><a id="a8e61d5ae14f01d57c4b14204727ed8f8"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a8e61d5ae14f01d57c4b14204727ed8f8">i_2_dcres</a></td></tr>
<tr class="memdesc:a8e61d5ae14f01d57c4b14204727ed8f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Second current measured during DC resistance state. <br /></td></tr>
<tr class="separator:a8e61d5ae14f01d57c4b14204727ed8f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e0b25759a62b1c0ee2ff911fa1aac40"><td class="memItemLeft" align="right" valign="top"><a id="a1e0b25759a62b1c0ee2ff911fa1aac40"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a1e0b25759a62b1c0ee2ff911fa1aac40">dc_res_val</a></td></tr>
<tr class="memdesc:a1e0b25759a62b1c0ee2ff911fa1aac40"><td class="mdescLeft">&#160;</td><td class="mdescRight">To store the operation of obtained from the DC resistance state. <br /></td></tr>
<tr class="separator:a1e0b25759a62b1c0ee2ff911fa1aac40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cc5d179fc4afa584f15244b35b01521"><td class="memItemLeft" align="right" valign="top"><a id="a0cc5d179fc4afa584f15244b35b01521"></a>
unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a0cc5d179fc4afa584f15244b35b01521">conv</a> = 0</td></tr>
<tr class="memdesc:a0cc5d179fc4afa584f15244b35b01521"><td class="mdescLeft">&#160;</td><td class="mdescRight">Turn controller ON(1) or OFF(0). Initialized as 0. <br /></td></tr>
<tr class="separator:a0cc5d179fc4afa584f15244b35b01521"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a9e89d63eb610dfe238b0a840979421"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a6a9e89d63eb610dfe238b0a840979421">count</a> = <a class="el" href="charger__discharger_8h.html#a7194053a42881b1b4bc8546b4c8713e9">COUNTER</a></td></tr>
<tr class="memdesc:a6a9e89d63eb610dfe238b0a840979421"><td class="mdescLeft">&#160;</td><td class="mdescRight">Counter that should be cleared every second. Initialized as <a class="el" href="charger__discharger_8h.html#a7194053a42881b1b4bc8546b4c8713e9" title="Counter value, needed to obtained one second between counts. ">COUNTER</a>.  <a href="#a6a9e89d63eb610dfe238b0a840979421">More...</a><br /></td></tr>
<tr class="separator:a6a9e89d63eb610dfe238b0a840979421"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02303eca810feb8092be2ff939a714c3"><td class="memItemLeft" align="right" valign="top"><a id="a02303eca810feb8092be2ff939a714c3"></a>
unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a02303eca810feb8092be2ff939a714c3">ad_res</a></td></tr>
<tr class="memdesc:a02303eca810feb8092be2ff939a714c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Result of an ADC measurement. <br /></td></tr>
<tr class="separator:a02303eca810feb8092be2ff939a714c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48d9522e58fa05906c6dba23e5745a72"><td class="memItemLeft" align="right" valign="top"><a id="a48d9522e58fa05906c6dba23e5745a72"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a48d9522e58fa05906c6dba23e5745a72">v</a></td></tr>
<tr class="memdesc:a48d9522e58fa05906c6dba23e5745a72"><td class="mdescLeft">&#160;</td><td class="mdescRight">Last voltage ADC measurement. <br /></td></tr>
<tr class="separator:a48d9522e58fa05906c6dba23e5745a72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58e739b7bdf8275493686ae76e3705c3"><td class="memItemLeft" align="right" valign="top"><a id="a58e739b7bdf8275493686ae76e3705c3"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a58e739b7bdf8275493686ae76e3705c3">i</a></td></tr>
<tr class="memdesc:a58e739b7bdf8275493686ae76e3705c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Last current ADC measurement. <br /></td></tr>
<tr class="separator:a58e739b7bdf8275493686ae76e3705c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afea36502e9d227ff62c5fb2719a246f2"><td class="memItemLeft" align="right" valign="top"><a id="afea36502e9d227ff62c5fb2719a246f2"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#afea36502e9d227ff62c5fb2719a246f2">t</a></td></tr>
<tr class="memdesc:afea36502e9d227ff62c5fb2719a246f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Last temperature ADC measurement. <br /></td></tr>
<tr class="separator:afea36502e9d227ff62c5fb2719a246f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8a45b535ece3b14958359be03fa74b0"><td class="memItemLeft" align="right" valign="top"><a id="aa8a45b535ece3b14958359be03fa74b0"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#aa8a45b535ece3b14958359be03fa74b0">vprom</a> = 0</td></tr>
<tr class="memdesc:aa8a45b535ece3b14958359be03fa74b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Last one-second-average of <a class="el" href="charger__discharger_8h.html#a48d9522e58fa05906c6dba23e5745a72" title="Last voltage ADC measurement. ">v</a> . Initialized as 0. <br /></td></tr>
<tr class="separator:aa8a45b535ece3b14958359be03fa74b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afce1f09585094a8102cf627d00de6d6f"><td class="memItemLeft" align="right" valign="top"><a id="afce1f09585094a8102cf627d00de6d6f"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#afce1f09585094a8102cf627d00de6d6f">iprom</a> = 0</td></tr>
<tr class="memdesc:afce1f09585094a8102cf627d00de6d6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Last one-second-average of <a class="el" href="charger__discharger_8h.html#a58e739b7bdf8275493686ae76e3705c3" title="Last current ADC measurement. ">i</a> . Initialized as 0. <br /></td></tr>
<tr class="separator:afce1f09585094a8102cf627d00de6d6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade869e001da18e227da4d9dbb0b616da"><td class="memItemLeft" align="right" valign="top"><a id="ade869e001da18e227da4d9dbb0b616da"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#ade869e001da18e227da4d9dbb0b616da">tprom</a> = 0</td></tr>
<tr class="memdesc:ade869e001da18e227da4d9dbb0b616da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Last one-second-average of <a class="el" href="charger__discharger_8h.html#afea36502e9d227ff62c5fb2719a246f2" title="Last temperature ADC measurement. ">t</a> . Initialized as 0. <br /></td></tr>
<tr class="separator:ade869e001da18e227da4d9dbb0b616da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16200aa761421d421187ce19c33dfcd0"><td class="memItemLeft" align="right" valign="top"><a id="a16200aa761421d421187ce19c33dfcd0"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a16200aa761421d421187ce19c33dfcd0">qprom</a> = 0</td></tr>
<tr class="memdesc:a16200aa761421d421187ce19c33dfcd0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Integration of <a class="el" href="charger__discharger_8h.html#a58e739b7bdf8275493686ae76e3705c3" title="Last current ADC measurement. ">i</a> . Initialized as 0. <br /></td></tr>
<tr class="separator:a16200aa761421d421187ce19c33dfcd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb4eb9ad2dc148d828a7f6e270aa0f09"><td class="memItemLeft" align="right" valign="top"><a id="aeb4eb9ad2dc148d828a7f6e270aa0f09"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#aeb4eb9ad2dc148d828a7f6e270aa0f09">vmax</a> = 0</td></tr>
<tr class="memdesc:aeb4eb9ad2dc148d828a7f6e270aa0f09"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum recorded average voltage. <br /></td></tr>
<tr class="separator:aeb4eb9ad2dc148d828a7f6e270aa0f09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad984965db113bd0969498c826e23ab44"><td class="memItemLeft" align="right" valign="top"><a id="ad984965db113bd0969498c826e23ab44"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#ad984965db113bd0969498c826e23ab44">proportional</a></td></tr>
<tr class="memdesc:ad984965db113bd0969498c826e23ab44"><td class="mdescLeft">&#160;</td><td class="mdescRight">Proportional component of PI compensator. <br /></td></tr>
<tr class="separator:ad984965db113bd0969498c826e23ab44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1174af01b8a329a6d465ea6e0951b3e5"><td class="memItemLeft" align="right" valign="top"><a id="a1174af01b8a329a6d465ea6e0951b3e5"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a1174af01b8a329a6d465ea6e0951b3e5">integral</a></td></tr>
<tr class="memdesc:a1174af01b8a329a6d465ea6e0951b3e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Integral component of PI compensator. <br /></td></tr>
<tr class="separator:a1174af01b8a329a6d465ea6e0951b3e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f7add0f84d583bc2eceb290d6c4cc06"><td class="memItemLeft" align="right" valign="top"><a id="a1f7add0f84d583bc2eceb290d6c4cc06"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a1f7add0f84d583bc2eceb290d6c4cc06">kp</a></td></tr>
<tr class="memdesc:a1f7add0f84d583bc2eceb290d6c4cc06"><td class="mdescLeft">&#160;</td><td class="mdescRight">Proportional compesator gain. <br /></td></tr>
<tr class="separator:a1f7add0f84d583bc2eceb290d6c4cc06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a050993b7ca6c97e62c1020017f716b91"><td class="memItemLeft" align="right" valign="top"><a id="a050993b7ca6c97e62c1020017f716b91"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a050993b7ca6c97e62c1020017f716b91">ki</a></td></tr>
<tr class="memdesc:a050993b7ca6c97e62c1020017f716b91"><td class="mdescLeft">&#160;</td><td class="mdescRight">Integral compesator gain. <br /></td></tr>
<tr class="separator:a050993b7ca6c97e62c1020017f716b91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12a556ee5b6e008717e9b6b8916c36a4"><td class="memItemLeft" align="right" valign="top"><a id="a12a556ee5b6e008717e9b6b8916c36a4"></a>
unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a12a556ee5b6e008717e9b6b8916c36a4">vref</a> = 0</td></tr>
<tr class="memdesc:a12a556ee5b6e008717e9b6b8916c36a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Voltage setpoint. Initialized as 0. <br /></td></tr>
<tr class="separator:a12a556ee5b6e008717e9b6b8916c36a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6bab6490e9e38ab60181b5cda64c53b"><td class="memItemLeft" align="right" valign="top"><a id="ab6bab6490e9e38ab60181b5cda64c53b"></a>
unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#ab6bab6490e9e38ab60181b5cda64c53b">iref</a> = 0</td></tr>
<tr class="memdesc:ab6bab6490e9e38ab60181b5cda64c53b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Current setpoint. Initialized as 0. <br /></td></tr>
<tr class="separator:ab6bab6490e9e38ab60181b5cda64c53b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa14de202054f8be3764087df08c27eda"><td class="memItemLeft" align="right" valign="top"><a id="aa14de202054f8be3764087df08c27eda"></a>
char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#aa14de202054f8be3764087df08c27eda">cmode</a></td></tr>
<tr class="memdesc:aa14de202054f8be3764087df08c27eda"><td class="mdescLeft">&#160;</td><td class="mdescRight">CC / CV selector. CC: <code> cmode = 1 </code>. CV: <code> cmode = 0 </code> <br /></td></tr>
<tr class="separator:aa14de202054f8be3764087df08c27eda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7feaae074885a9d2f57a75e0809ee4ba"><td class="memItemLeft" align="right" valign="top"><a id="a7feaae074885a9d2f57a75e0809ee4ba"></a>
unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a7feaae074885a9d2f57a75e0809ee4ba">dc</a> = 0</td></tr>
<tr class="memdesc:a7feaae074885a9d2f57a75e0809ee4ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Duty cycle. <br /></td></tr>
<tr class="separator:a7feaae074885a9d2f57a75e0809ee4ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ac955a54afa8f9039b93a3f30b04acd"><td class="memItemLeft" align="right" valign="top"><a id="a2ac955a54afa8f9039b93a3f30b04acd"></a>
char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a2ac955a54afa8f9039b93a3f30b04acd">clear</a></td></tr>
<tr class="memdesc:a2ac955a54afa8f9039b93a3f30b04acd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Variable to clear the transmission buffer of UART. <br /></td></tr>
<tr class="separator:a2ac955a54afa8f9039b93a3f30b04acd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c9205727cab72e65f536e9ef6445db0"><td class="memItemLeft" align="right" valign="top"><a id="a8c9205727cab72e65f536e9ef6445db0"></a>
unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a8c9205727cab72e65f536e9ef6445db0">log_on</a> = 0</td></tr>
<tr class="memdesc:a8c9205727cab72e65f536e9ef6445db0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Variable to indicate if the log is activated. <br /></td></tr>
<tr class="separator:a8c9205727cab72e65f536e9ef6445db0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20f2ad896b5d2be3ebe2145c7b00e033"><td class="memItemLeft" align="right" valign="top"><a id="a20f2ad896b5d2be3ebe2145c7b00e033"></a>
char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033">log_buffer</a> [8] ={0}</td></tr>
<tr class="memdesc:a20f2ad896b5d2be3ebe2145c7b00e033"><td class="mdescLeft">&#160;</td><td class="mdescRight">Temporary buffer used between loops of <a class="el" href="charger__discharger_8h.html#a0b8b498532d1d667c624601a3cf715bc" title="This function takes care of printing the test data using the UART. ">log_control()</a> <br /></td></tr>
<tr class="separator:a20f2ad896b5d2be3ebe2145c7b00e033"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a639c6c3902af09dac255279f04f0db89"><td class="memItemLeft" align="right" valign="top"><a id="a639c6c3902af09dac255279f04f0db89"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a639c6c3902af09dac255279f04f0db89">ip_buff</a> = 0</td></tr>
<tr class="memdesc:a639c6c3902af09dac255279f04f0db89"><td class="mdescLeft">&#160;</td><td class="mdescRight">Current buffer to send to the terminal usign <a class="el" href="charger__discharger_8h.html#a0b8b498532d1d667c624601a3cf715bc" title="This function takes care of printing the test data using the UART. ">log_control()</a> <br /></td></tr>
<tr class="separator:a639c6c3902af09dac255279f04f0db89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9b685d478b266b9155c576dd4da0dc0"><td class="memItemLeft" align="right" valign="top"><a id="aa9b685d478b266b9155c576dd4da0dc0"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#aa9b685d478b266b9155c576dd4da0dc0">vp_buff</a> = 0</td></tr>
<tr class="memdesc:aa9b685d478b266b9155c576dd4da0dc0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Voltage buffer to send to the terminal usign <a class="el" href="charger__discharger_8h.html#a0b8b498532d1d667c624601a3cf715bc" title="This function takes care of printing the test data using the UART. ">log_control()</a> <br /></td></tr>
<tr class="separator:aa9b685d478b266b9155c576dd4da0dc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f437b35570f9f0fd44ec4ba168ac115"><td class="memItemLeft" align="right" valign="top"><a id="a9f437b35570f9f0fd44ec4ba168ac115"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a9f437b35570f9f0fd44ec4ba168ac115">tp_buff</a> = 0</td></tr>
<tr class="memdesc:a9f437b35570f9f0fd44ec4ba168ac115"><td class="mdescLeft">&#160;</td><td class="mdescRight">Temperature buffer to send to the terminal usign (). <br /></td></tr>
<tr class="separator:a9f437b35570f9f0fd44ec4ba168ac115"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7319d00b273407ffe5f28b29e97a1c7"><td class="memItemLeft" align="right" valign="top"><a id="af7319d00b273407ffe5f28b29e97a1c7"></a>
unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#af7319d00b273407ffe5f28b29e97a1c7">qp_buff</a> = 0</td></tr>
<tr class="memdesc:af7319d00b273407ffe5f28b29e97a1c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Capacity buffer to send to the terminal usign <a class="el" href="charger__discharger_8h.html#a0b8b498532d1d667c624601a3cf715bc" title="This function takes care of printing the test data using the UART. ">log_control()</a> . <br /></td></tr>
<tr class="separator:af7319d00b273407ffe5f28b29e97a1c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cf35be1947a62f134392fcb1b3c54d2"><td class="memItemLeft" align="right" valign="top"><a id="a6cf35be1947a62f134392fcb1b3c54d2"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a6cf35be1947a62f134392fcb1b3c54d2">second</a> = 0</td></tr>
<tr class="memdesc:a6cf35be1947a62f134392fcb1b3c54d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Seconds counter, resetted after 59 seconds. <br /></td></tr>
<tr class="separator:a6cf35be1947a62f134392fcb1b3c54d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5edffad982a0566ad01d95005474eae3"><td class="memItemLeft" align="right" valign="top"><a id="a5edffad982a0566ad01d95005474eae3"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="charger__discharger_8h.html#a5edffad982a0566ad01d95005474eae3">minute</a> = 0</td></tr>
<tr class="memdesc:a5edffad982a0566ad01d95005474eae3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Minutes counter, only manually reset. <br /></td></tr>
<tr class="separator:a5edffad982a0566ad01d95005474eae3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bd15b1b4bbdd7329986c9c4af33d10d"><td class="memItemLeft" align="right" valign="top"><a id="a7bd15b1b4bbdd7329986c9c4af33d10d"></a>
unsigned&#160;</td><td class="memItemRight" valign="bottom"><b>timeout</b> = 0</td></tr>
<tr class="separator:a7bd15b1b4bbdd7329986c9c4af33d10d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43e0a97c0d8ad515b444eb349134d9ad"><td class="memItemLeft" align="right" valign="top"><a id="a43e0a97c0d8ad515b444eb349134d9ad"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>comma</b> = ','</td></tr>
<tr class="separator:a43e0a97c0d8ad515b444eb349134d9ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6566afc517c1e78ec8c5d1254968b8de"><td class="memItemLeft" align="right" valign="top"><a id="a6566afc517c1e78ec8c5d1254968b8de"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>colons</b> = ':'</td></tr>
<tr class="separator:a6566afc517c1e78ec8c5d1254968b8de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af22eabf79fefb1021751f5c96dba82c1"><td class="memItemLeft" align="right" valign="top"><a id="af22eabf79fefb1021751f5c96dba82c1"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>S_str</b> = 'S'</td></tr>
<tr class="separator:af22eabf79fefb1021751f5c96dba82c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a372df28ca2dd6d5c28b2e24f8b2191b1"><td class="memItemLeft" align="right" valign="top"><a id="a372df28ca2dd6d5c28b2e24f8b2191b1"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>C_str</b> = 'C'</td></tr>
<tr class="separator:a372df28ca2dd6d5c28b2e24f8b2191b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad192efa8f8a61829c3f21b83dccaa8a4"><td class="memItemLeft" align="right" valign="top"><a id="ad192efa8f8a61829c3f21b83dccaa8a4"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>V_str</b> = 'V'</td></tr>
<tr class="separator:ad192efa8f8a61829c3f21b83dccaa8a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5286907f5157a3240106f0dfa37d5dc"><td class="memItemLeft" align="right" valign="top"><a id="af5286907f5157a3240106f0dfa37d5dc"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>I_str</b> = 'I'</td></tr>
<tr class="separator:af5286907f5157a3240106f0dfa37d5dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adda72d580036fe63aca283d37a974f36"><td class="memItemLeft" align="right" valign="top"><a id="adda72d580036fe63aca283d37a974f36"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>T_str</b> = 'T'</td></tr>
<tr class="separator:adda72d580036fe63aca283d37a974f36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70c943b584242ce58c0ded2ab26abcc5"><td class="memItemLeft" align="right" valign="top"><a id="a70c943b584242ce58c0ded2ab26abcc5"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>Q_str</b> = 'Q'</td></tr>
<tr class="separator:a70c943b584242ce58c0ded2ab26abcc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5fe4dd2877e813e414fcec5a01056bd"><td class="memItemLeft" align="right" valign="top"><a id="ab5fe4dd2877e813e414fcec5a01056bd"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>R_str</b> = 'R'</td></tr>
<tr class="separator:ab5fe4dd2877e813e414fcec5a01056bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af97d1d3fa767a6ec1ac8a236112a065d"><td class="memItemLeft" align="right" valign="top"><a id="af97d1d3fa767a6ec1ac8a236112a065d"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>W_str</b> = 'W'</td></tr>
<tr class="separator:af97d1d3fa767a6ec1ac8a236112a065d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91e529a9e95de4d3e44000218b5f02b3"><td class="memItemLeft" align="right" valign="top"><a id="a91e529a9e95de4d3e44000218b5f02b3"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>press_s_str</b> [] = &quot;Press 's' to start: &quot;</td></tr>
<tr class="separator:a91e529a9e95de4d3e44000218b5f02b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e72a8140df9b0184966d82a224e4a43"><td class="memItemLeft" align="right" valign="top"><a id="a4e72a8140df9b0184966d82a224e4a43"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>starting_str</b> [] = &quot;Starting...&quot;</td></tr>
<tr class="separator:a4e72a8140df9b0184966d82a224e4a43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a710856a549a2706083bdd369b95bc179"><td class="memItemLeft" align="right" valign="top"><a id="a710856a549a2706083bdd369b95bc179"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>done_str</b> [] = &quot;DONE&quot;</td></tr>
<tr class="separator:a710856a549a2706083bdd369b95bc179"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d30ddd22dad30b60ffed7aa3b538f5a"><td class="memItemLeft" align="right" valign="top"><a id="a9d30ddd22dad30b60ffed7aa3b538f5a"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>num_1and2_str</b> [] = &quot;Please input a number between 1 and 2&quot;</td></tr>
<tr class="separator:a9d30ddd22dad30b60ffed7aa3b538f5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a814d4440d23060c6d7ca647e050f7cfd"><td class="memItemLeft" align="right" valign="top"><a id="a814d4440d23060c6d7ca647e050f7cfd"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>num_1and3_str</b> [] = &quot;Please input a number between 1 and 3&quot;</td></tr>
<tr class="separator:a814d4440d23060c6d7ca647e050f7cfd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe2d116bb9b6a4a402c4210368292297"><td class="memItemLeft" align="right" valign="top"><a id="afe2d116bb9b6a4a402c4210368292297"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>num_1and4_str</b> [] = &quot;Please input a number between 1 and 4&quot;</td></tr>
<tr class="separator:afe2d116bb9b6a4a402c4210368292297"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27c2cf123a74c2b276de0c32bb88cc87"><td class="memItemLeft" align="right" valign="top"><a id="a27c2cf123a74c2b276de0c32bb88cc87"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>param_def_str</b> [] = &quot;---Parameter definition for charger and discharger---&quot;</td></tr>
<tr class="separator:a27c2cf123a74c2b276de0c32bb88cc87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e84886842df542b6aa4117a4985997b"><td class="memItemLeft" align="right" valign="top"><a id="a6e84886842df542b6aa4117a4985997b"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>restarting_str</b> [] = &quot;Restarting...&quot;</td></tr>
<tr class="separator:a6e84886842df542b6aa4117a4985997b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa18f769fd923582d32f0e1ceb9ff1a3e"><td class="memItemLeft" align="right" valign="top"><a id="aa18f769fd923582d32f0e1ceb9ff1a3e"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>chem_def_liion</b> [] = &quot;Chemistry defined as Li-Ion&quot;</td></tr>
<tr class="separator:aa18f769fd923582d32f0e1ceb9ff1a3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab71f311f1a8aac2bf591ed9455ed9cba"><td class="memItemLeft" align="right" valign="top"><a id="ab71f311f1a8aac2bf591ed9455ed9cba"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>chem_def_nimh</b> [] = &quot;Chemistry defined as Ni-MH&quot;</td></tr>
<tr class="separator:ab71f311f1a8aac2bf591ed9455ed9cba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b007f16888d4d20e6e9a8c9ddb5034e"><td class="memItemLeft" align="right" valign="top"><a id="a2b007f16888d4d20e6e9a8c9ddb5034e"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>mV_str</b> [] = &quot; mV&quot;</td></tr>
<tr class="separator:a2b007f16888d4d20e6e9a8c9ddb5034e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a182c823b33a629ff5d6e32bb03725f0d"><td class="memItemLeft" align="right" valign="top"><a id="a182c823b33a629ff5d6e32bb03725f0d"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>mAh_str</b> [] = &quot; mAh&quot;</td></tr>
<tr class="separator:a182c823b33a629ff5d6e32bb03725f0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a429b7a40fb32bd9fa16ee483a111219e"><td class="memItemLeft" align="right" valign="top"><a id="a429b7a40fb32bd9fa16ee483a111219e"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>mA_str</b> [] = &quot; mA&quot;</td></tr>
<tr class="separator:a429b7a40fb32bd9fa16ee483a111219e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9393ea939d20c53efc26e49d05e9369d"><td class="memItemLeft" align="right" valign="top"><a id="a9393ea939d20c53efc26e49d05e9369d"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>EOD_V_str</b> [] = &quot;End of discharge voltage: &quot;</td></tr>
<tr class="separator:a9393ea939d20c53efc26e49d05e9369d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafae06f345b48fed8a1908d0cd0a84e2"><td class="memItemLeft" align="right" valign="top"><a id="aafae06f345b48fed8a1908d0cd0a84e2"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>EOC_I_str</b> [] = &quot;End of charge current: &quot;</td></tr>
<tr class="separator:aafae06f345b48fed8a1908d0cd0a84e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd010dae58c2494b4615f2bf35398424"><td class="memItemLeft" align="right" valign="top"><a id="acd010dae58c2494b4615f2bf35398424"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>EOC_DV_str</b> [] = &quot;End of charge voltage drop: &quot;</td></tr>
<tr class="separator:acd010dae58c2494b4615f2bf35398424"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fff21a1610991bd0a87d0a2a77d0f60"><td class="memItemLeft" align="right" valign="top"><a id="a1fff21a1610991bd0a87d0a2a77d0f60"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>cho_bet_str</b> [] = &quot;Chose between following options: &quot;</td></tr>
<tr class="separator:a1fff21a1610991bd0a87d0a2a77d0f60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a284f0268ca3e501b485f8ee5549d27e2"><td class="memItemLeft" align="right" valign="top"><a id="a284f0268ca3e501b485f8ee5549d27e2"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>quarter_c_str</b> [] = &quot;(1) 0.25C&quot;</td></tr>
<tr class="separator:a284f0268ca3e501b485f8ee5549d27e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab969b52eb0314da6b83b35483dfba7a1"><td class="memItemLeft" align="right" valign="top"><a id="ab969b52eb0314da6b83b35483dfba7a1"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>half_c_str</b> [] = &quot;(2) 0.50C&quot;</td></tr>
<tr class="separator:ab969b52eb0314da6b83b35483dfba7a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a410ee1698dbdc5fdc0be790cfa7b03c0"><td class="memItemLeft" align="right" valign="top"><a id="a410ee1698dbdc5fdc0be790cfa7b03c0"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>one_c_str</b> [] = &quot;(3) 1C&quot;</td></tr>
<tr class="separator:a410ee1698dbdc5fdc0be790cfa7b03c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6892bda03919f5470b55eaa9b2d0c90"><td class="memItemLeft" align="right" valign="top"><a id="ab6892bda03919f5470b55eaa9b2d0c90"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>cell_str</b> [] = &quot;Cell &quot;</td></tr>
<tr class="separator:ab6892bda03919f5470b55eaa9b2d0c90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a551eda5de85ae4fa3627d60ee229193b"><td class="memItemLeft" align="right" valign="top"><a id="a551eda5de85ae4fa3627d60ee229193b"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>dis_def_quarter_str</b> [] = &quot;Discharge current defined as 0.25C&quot;</td></tr>
<tr class="separator:a551eda5de85ae4fa3627d60ee229193b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef170ec65796e63a3a46e5484d8b2f20"><td class="memItemLeft" align="right" valign="top"><a id="aef170ec65796e63a3a46e5484d8b2f20"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>dis_def_half_str</b> [] = &quot;Discharge current defined as 0.5C&quot;</td></tr>
<tr class="separator:aef170ec65796e63a3a46e5484d8b2f20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a769237f2584e8f3f2947ba11d7051b0d"><td class="memItemLeft" align="right" valign="top"><a id="a769237f2584e8f3f2947ba11d7051b0d"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>dis_def_one_str</b> [] = &quot;Discharge current defined as 1C&quot;</td></tr>
<tr class="separator:a769237f2584e8f3f2947ba11d7051b0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf6025401978a7fcc9e78daebfb90576"><td class="memItemLeft" align="right" valign="top"><a id="adf6025401978a7fcc9e78daebfb90576"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>char_def_quarter_str</b> [] = &quot;Charge current defined as 0.25C&quot;</td></tr>
<tr class="separator:adf6025401978a7fcc9e78daebfb90576"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02c81aa640f888c1f0c830471cc24a82"><td class="memItemLeft" align="right" valign="top"><a id="a02c81aa640f888c1f0c830471cc24a82"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>char_def_half_str</b> [] = &quot;Charge current defined as 0.5C&quot;</td></tr>
<tr class="separator:a02c81aa640f888c1f0c830471cc24a82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa01e0b2be9a3c5ff2080ba709348d2ff"><td class="memItemLeft" align="right" valign="top"><a id="aa01e0b2be9a3c5ff2080ba709348d2ff"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>char_def_one_str</b> [] = &quot;Charge current defined as 1C&quot;</td></tr>
<tr class="separator:aa01e0b2be9a3c5ff2080ba709348d2ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac61f3ba257415a95ef8f00e5c5c44eb2"><td class="memItemLeft" align="right" valign="top"><a id="ac61f3ba257415a95ef8f00e5c5c44eb2"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>cv_val_str</b> [] = &quot;Constant voltage value: &quot;</td></tr>
<tr class="separator:ac61f3ba257415a95ef8f00e5c5c44eb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0adfbdf284ca1b13c49058b9b6c139f6"><td class="memItemLeft" align="right" valign="top"><a id="a0adfbdf284ca1b13c49058b9b6c139f6"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>nom_cap_str</b> [] = &quot;Nominal capacity: &quot;</td></tr>
<tr class="separator:a0adfbdf284ca1b13c49058b9b6c139f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7f6c7694f68bfdc6d42edf38d098c8a"><td class="memItemLeft" align="right" valign="top"><a id="ab7f6c7694f68bfdc6d42edf38d098c8a"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>def_char_curr_str</b> [] = &quot;Define charge current (input the number): &quot;</td></tr>
<tr class="separator:ab7f6c7694f68bfdc6d42edf38d098c8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2942d095029e520cd38bcae077dfdb05"><td class="memItemLeft" align="right" valign="top"><a id="a2942d095029e520cd38bcae077dfdb05"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>def_disc_curr_str</b> [] = &quot;Define discharge current (input the number): &quot;</td></tr>
<tr class="separator:a2942d095029e520cd38bcae077dfdb05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ab8f2affad053697db60e7c2ec83266"><td class="memItemLeft" align="right" valign="top"><a id="a2ab8f2affad053697db60e7c2ec83266"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>def_num_cell_str</b> [] = &quot;Define number of cells to be tested (input the number, maximum of 4): &quot;</td></tr>
<tr class="separator:a2ab8f2affad053697db60e7c2ec83266"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac62f424eed8df92c38c616425f2bdb99"><td class="memItemLeft" align="right" valign="top"><a id="ac62f424eed8df92c38c616425f2bdb99"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>num_cell_str</b> [] = &quot;Number of cells to be tested: &quot;</td></tr>
<tr class="separator:ac62f424eed8df92c38c616425f2bdb99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c1708638a3711c33c3754818b88aaab"><td class="memItemLeft" align="right" valign="top"><a id="a1c1708638a3711c33c3754818b88aaab"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>one_str</b> [] = &quot;1&quot;</td></tr>
<tr class="separator:a1c1708638a3711c33c3754818b88aaab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4501e00437dc146c0fed3e12d7db1638"><td class="memItemLeft" align="right" valign="top"><a id="a4501e00437dc146c0fed3e12d7db1638"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>two_str</b> [] = &quot;2&quot;</td></tr>
<tr class="separator:a4501e00437dc146c0fed3e12d7db1638"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6867a7d1919a8ea0fae36ebcf788af9"><td class="memItemLeft" align="right" valign="top"><a id="ad6867a7d1919a8ea0fae36ebcf788af9"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>three_str</b> [] = &quot;3&quot;</td></tr>
<tr class="separator:ad6867a7d1919a8ea0fae36ebcf788af9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a539dcdeb3c162e5f4b075c398f9f439d"><td class="memItemLeft" align="right" valign="top"><a id="a539dcdeb3c162e5f4b075c398f9f439d"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>four_str</b> [] = &quot;4&quot;</td></tr>
<tr class="separator:a539dcdeb3c162e5f4b075c398f9f439d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0627a57f283baa5ab2665749acd118f2"><td class="memItemLeft" align="right" valign="top"><a id="a0627a57f283baa5ab2665749acd118f2"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>op_1_str</b> [] = &quot;(1) Predischarge-&gt;Charge-&gt;Discharge-&gt;Postcharge&quot;</td></tr>
<tr class="separator:a0627a57f283baa5ab2665749acd118f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a103590cbaa0ac12766c4195813c2a64d"><td class="memItemLeft" align="right" valign="top"><a id="a103590cbaa0ac12766c4195813c2a64d"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>op_2_str</b> [] = &quot;(2) Charge-&gt;Discharge&quot;</td></tr>
<tr class="separator:a103590cbaa0ac12766c4195813c2a64d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98c57f34817da888d59ef90ee6c7bfc8"><td class="memItemLeft" align="right" valign="top"><a id="a98c57f34817da888d59ef90ee6c7bfc8"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>op_3_str</b> [] = &quot;(3) Only Charge&quot;</td></tr>
<tr class="separator:a98c57f34817da888d59ef90ee6c7bfc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70e90efb0323214d9055083fe25bc566"><td class="memItemLeft" align="right" valign="top"><a id="a70e90efb0323214d9055083fe25bc566"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>op_4_str</b> [] = &quot;(4) Only Discharge&quot;</td></tr>
<tr class="separator:a70e90efb0323214d9055083fe25bc566"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cd6e863e75381f276fe2420b9ded0cb"><td class="memItemLeft" align="right" valign="top"><a id="a6cd6e863e75381f276fe2420b9ded0cb"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>op_1_sel_str</b> [] = &quot;Predischarge-&gt;Charge-&gt;Discharge-&gt;Postcharge selected...&quot;</td></tr>
<tr class="separator:a6cd6e863e75381f276fe2420b9ded0cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a069422f5f724d21f518c42b9fd6bde"><td class="memItemLeft" align="right" valign="top"><a id="a1a069422f5f724d21f518c42b9fd6bde"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>op_2_sel_str</b> [] = &quot;Charge-&gt;Discharge selected...&quot;</td></tr>
<tr class="separator:a1a069422f5f724d21f518c42b9fd6bde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfff49bdd1487d0491bb87b851acc7cf"><td class="memItemLeft" align="right" valign="top"><a id="abfff49bdd1487d0491bb87b851acc7cf"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>op_3_sel_str</b> [] = &quot;Only Charge selected...&quot;</td></tr>
<tr class="separator:abfff49bdd1487d0491bb87b851acc7cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e58f605e86847bfa935ab585f155161"><td class="memItemLeft" align="right" valign="top"><a id="a5e58f605e86847bfa935ab585f155161"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>op_4_sel_str</b> [] = &quot;Only Discharge selected...&quot;</td></tr>
<tr class="separator:a5e58f605e86847bfa935ab585f155161"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a138648efb4ba60bc05e036bfbac7572a"><td class="memItemLeft" align="right" valign="top"><a id="a138648efb4ba60bc05e036bfbac7572a"></a>
char const&#160;</td><td class="memItemRight" valign="bottom"><b>cell_below_str</b> [] = &quot;Cell below 0.9V or not present&quot;</td></tr>
<tr class="separator:a138648efb4ba60bc05e036bfbac7572a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>State machine header file for Charge and Discharge System. </p>
<dl class="section author"><dt>Author</dt><dd>Juan J. Rojas </dd></dl>
<dl class="section date"><dt>Date</dt><dd>7 Aug 2018 </dd></dl>
<dl class="section user"><dt>Institution:</dt><dd>LaSEINE / CeNT. Kyushu Institute of Technology. </dd></dl>
<dl class="section user"><dt>Mail (after leaving Kyutech):</dt><dd><a href="#" onclick="location.href='mai'+'lto:'+'jua'+'n.'+'roj'+'as'+'@te'+'c.'+'ac.'+'cr'; return false;">juan.<span style="display: none;">.nosp@m.</span>roja<span style="display: none;">.nosp@m.</span>s@tec<span style="display: none;">.nosp@m.</span>.ac.<span style="display: none;">.nosp@m.</span>cr</a> </dd></dl>
<dl class="section user"><dt>Git repository:</dt><dd><a href="https://bitbucket.org/juanjorojash/cell_charger_discharger">https://bitbucket.org/juanjorojash/cell_charger_discharger</a> </dd></dl>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ae1cb4a0872e924cf862a97b33dd2edf0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1cb4a0872e924cf862a97b33dd2edf0">&#9670;&nbsp;</a></span>STOP_CONVERTER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STOP_CONVERTER</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;{ <a class="el" href="charger__discharger_8h.html#a0cc5d179fc4afa584f15244b35b01521">conv</a> = 0; RA1 = 1; <a class="el" href="charger__discharger_8h.html#a7feaae074885a9d2f57a75e0809ee4ba">dc</a> = <a class="el" href="charger__discharger_8h.html#a998e4507851dde706a60a5b475eb27ca">DC_MIN</a>; <a class="el" href="charger__discharger_8h.html#a93f3630c962d9bcafd71e4c4a03547c1">set_DC</a>(); <a class="el" href="charger__discharger_8h.html#a5bbc85db8cf08142e0984d07b97e722b">Cell_OFF</a>(); <a class="el" href="charger__discharger_8h.html#a2f57a3156036b713dc852737da390252">LOG_OFF</a>();}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stop the converter. </p>
<p>Set <code>conv</code> to zero, turn off the main relay (<code>RA1</code>), set the duty cycle in <code>DC_MIN</code>, turn off all the cell relays in the switcher board, disable the logging of data to the terminal and the UART reception interrupts. </p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="aa19be6305a5a4485e1e70de70ed7d677"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa19be6305a5a4485e1e70de70ed7d677">&#9670;&nbsp;</a></span>states</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677">states</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This is the State Machine enum </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="aa19be6305a5a4485e1e70de70ed7d677ae4634ae4352b512b38c5da9dc1610ca6"></a>STANDBY&#160;</td><td class="fielddoc"><p>"Stand by" state, defined by function <a class="el" href="charger__discharger_8h.html#a617e0199133fdef0d3a3e6a4a4c39c7e">fSTANDBY()</a> </p>
</td></tr>
<tr><td class="fieldname"><a id="aa19be6305a5a4485e1e70de70ed7d677afd6a0e4343048b10646dd2976cc5ad18"></a>IDLE&#160;</td><td class="fielddoc"><p>"Idle" state, defined by function <a class="el" href="charger__discharger_8h.html#af14972c8bcddf306a0cc7f7f43a5e3c1">fIDLE()</a> </p>
</td></tr>
<tr><td class="fieldname"><a id="aa19be6305a5a4485e1e70de70ed7d677ab7f3a434cd7c576917ad58613673c571"></a>FAULT&#160;</td><td class="fielddoc"><p>"Fault" state, defined by function <a class="el" href="charger__discharger_8h.html#aa309f5ae96bb5d30d1097731fc373f1f">fFAULT()</a> </p>
</td></tr>
<tr><td class="fieldname"><a id="aa19be6305a5a4485e1e70de70ed7d677a2df4f4d04ec310a30dd8eaac64f883a2"></a>ISDONE&#160;</td><td class="fielddoc"><p>"Is done" state, defined by function <a class="el" href="charger__discharger_8h.html#a6f57fe99a95d5951b37346f2e592a033">fISDONE()</a> </p>
</td></tr>
<tr><td class="fieldname"><a id="aa19be6305a5a4485e1e70de70ed7d677a79a322ccb4b29b85b3cab52dbccefd17"></a>WAIT&#160;</td><td class="fielddoc"><p>"Wait" state, defined by function <a class="el" href="charger__discharger_8h.html#a621fb7a48066389e0889ad9f7413f6c9">fWAIT()</a> </p>
</td></tr>
<tr><td class="fieldname"><a id="aa19be6305a5a4485e1e70de70ed7d677a95c89aa15e7cbe4ca2a03d955a4b067c"></a>PREDISCHARGE&#160;</td><td class="fielddoc"><p>"Predischarge" state, defined by function <a class="el" href="charger__discharger_8h.html#ad25aed7556b1faba14a86a62f1dd4f89">fDISCHARGE()</a> </p>
</td></tr>
<tr><td class="fieldname"><a id="aa19be6305a5a4485e1e70de70ed7d677aea7debd6c1f7cf2d27b8774acac4109f"></a>CHARGE&#160;</td><td class="fielddoc"><p>"Charge" state, defined by function <a class="el" href="charger__discharger_8h.html#a0c4e2b572b4dd0ba38a90c7721edf3d8">fCHARGE()</a> </p>
</td></tr>
<tr><td class="fieldname"><a id="aa19be6305a5a4485e1e70de70ed7d677adfece03792e81dc232ae4f15fee2a423"></a>DISCHARGE&#160;</td><td class="fielddoc"><p>"Discharge" state, defined by function <a class="el" href="charger__discharger_8h.html#ad25aed7556b1faba14a86a62f1dd4f89">fDISCHARGE()</a> </p>
</td></tr>
<tr><td class="fieldname"><a id="aa19be6305a5a4485e1e70de70ed7d677a90827714b4165a402681b4ce4874e5f0"></a>POSTCHARGE&#160;</td><td class="fielddoc"><p>"Postcharge" state, defined by function <a class="el" href="charger__discharger_8h.html#a0c4e2b572b4dd0ba38a90c7721edf3d8">fCHARGE()</a> </p>
</td></tr>
<tr><td class="fieldname"><a id="aa19be6305a5a4485e1e70de70ed7d677a5d64f3582250fabf9443c93ca77ecf9c"></a>DS_DC_res&#160;</td><td class="fielddoc"><p>"Discharged state DC resistance" state, defined by function <a class="el" href="charger__discharger_8h.html#a0b36b83531f2626d071ba3d1115ba83f">fDC_res()</a> </p>
</td></tr>
<tr><td class="fieldname"><a id="aa19be6305a5a4485e1e70de70ed7d677a031d03f2aee61a88f34151e0b532df5b"></a>CS_DC_res&#160;</td><td class="fielddoc"><p>"Charged state DC resistance" state, defined by function <a class="el" href="charger__discharger_8h.html#a0b36b83531f2626d071ba3d1115ba83f">fDC_res()</a> </p>
</td></tr>
<tr><td class="fieldname"><a id="aa19be6305a5a4485e1e70de70ed7d677a68bd1d9b6b5d032caefff13585f9d22b"></a>PS_DC_res&#160;</td><td class="fielddoc"><p>"Postcharged state DC resistance" state, defined by function <a class="el" href="charger__discharger_8h.html#a0b36b83531f2626d071ba3d1115ba83f">fDC_res()</a> </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ab2f580a1d85442504950b07e3c8f1145"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2f580a1d85442504950b07e3c8f1145">&#9670;&nbsp;</a></span>calculate_avg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calculate_avg </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function calculate the averages. </p>
<p>If <a class="el" href="charger__discharger_8h.html#a6a9e89d63eb610dfe238b0a840979421" title="Counter that should be cleared every second. Initialized as COUNTER. ">count</a> = <a class="el" href="charger__discharger_8h.html#a7194053a42881b1b4bc8546b4c8713e9" title="Counter value, needed to obtained one second between counts. ">COUNTER</a></p>
<ul>
<li>Make <a class="el" href="charger__discharger_8h.html#afce1f09585094a8102cf627d00de6d6f" title="Last one-second-average of i . Initialized as 0. ">iprom</a> zero</li>
<li>Make <a class="el" href="charger__discharger_8h.html#aa8a45b535ece3b14958359be03fa74b0" title="Last one-second-average of v . Initialized as 0. ">vprom</a> zero</li>
<li>Make <a class="el" href="charger__discharger_8h.html#ade869e001da18e227da4d9dbb0b616da" title="Last one-second-average of t . Initialized as 0. ">tprom</a> zero</li>
</ul>
<p>If <a class="el" href="charger__discharger_8h.html#a6a9e89d63eb610dfe238b0a840979421" title="Counter that should be cleared every second. Initialized as COUNTER. ">count</a> = 0</p>
<ul>
<li>Divide the value stored in <a class="el" href="charger__discharger_8h.html#afce1f09585094a8102cf627d00de6d6f" title="Last one-second-average of i . Initialized as 0. ">iprom</a> between COUNTER to obtain the average</li>
<li>Divide the value stored in <a class="el" href="charger__discharger_8h.html#aa8a45b535ece3b14958359be03fa74b0" title="Last one-second-average of v . Initialized as 0. ">vprom</a> between COUNTER to obtain the average</li>
<li>Divide the value stored in <a class="el" href="charger__discharger_8h.html#ade869e001da18e227da4d9dbb0b616da" title="Last one-second-average of t . Initialized as 0. ">tprom</a> between COUNTER to obtain the average</li>
<li>Divide <a class="el" href="charger__discharger_8h.html#afce1f09585094a8102cf627d00de6d6f" title="Last one-second-average of i . Initialized as 0. ">iprom</a> between 3600 and add it to <a class="el" href="charger__discharger_8h.html#a16200aa761421d421187ce19c33dfcd0" title="Integration of i . Initialized as 0. ">qprom</a> to integrate the current over time</li>
<li>If is the chemistry is Ni-MH and <a class="el" href="charger__discharger_8h.html#aa8a45b535ece3b14958359be03fa74b0" title="Last one-second-average of v . Initialized as 0. ">vprom</a> is bigger than <a class="el" href="charger__discharger_8h.html#aeb4eb9ad2dc148d828a7f6e270aa0f09" title="Maximum recorded average voltage. ">vmax</a> then set <a class="el" href="charger__discharger_8h.html#aeb4eb9ad2dc148d828a7f6e270aa0f09" title="Maximum recorded average voltage. ">vmax</a> = <a class="el" href="charger__discharger_8h.html#aa8a45b535ece3b14958359be03fa74b0" title="Last one-second-average of v . Initialized as 0. ">vprom</a></li>
</ul>
<p>If <a class="el" href="charger__discharger_8h.html#a6a9e89d63eb610dfe238b0a840979421" title="Counter that should be cleared every second. Initialized as COUNTER. ">count</a> is not any of the previous cases then</p>
<ul>
<li>Accumulate <a class="el" href="charger__discharger_8h.html#a58e739b7bdf8275493686ae76e3705c3" title="Last current ADC measurement. ">i</a> in <a class="el" href="charger__discharger_8h.html#afce1f09585094a8102cf627d00de6d6f" title="Last one-second-average of i . Initialized as 0. ">iprom</a></li>
<li>Accumulate <a class="el" href="charger__discharger_8h.html#a48d9522e58fa05906c6dba23e5745a72" title="Last voltage ADC measurement. ">v</a> in <a class="el" href="charger__discharger_8h.html#aa8a45b535ece3b14958359be03fa74b0" title="Last one-second-average of v . Initialized as 0. ">vprom</a> </li>
</ul>

</div>
</div>
<a id="a9ab308304942d68ad5733f1a0a9685a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ab308304942d68ad5733f1a0a9685a4">&#9670;&nbsp;</a></span>cc_cv_mode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cc_cv_mode </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>current_voltage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>reference_voltage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>CC_mode_status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function switches between CC and CV mode. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_voltage</td><td>average of current voltage </td></tr>
    <tr><td class="paramname">referece_voltage</td><td>voltage setpoint </td></tr>
    <tr><td class="paramname">CC_mode_status</td><td>current condition of <a class="el" href="charger__discharger_8h.html#aa14de202054f8be3764087df08c27eda" title="CC / CV selector. CC:  cmode = 1 . CV:  cmode = 0  ">cmode</a> variable </td></tr>
  </table>
  </dd>
</dl>
<p>If the current voltage is bigger than the voltage setpoint and the system is in CC mode, then:</p>
<ul>
<li>The <a class="el" href="charger__discharger_8h.html#ad984965db113bd0969498c826e23ab44" title="Proportional component of PI compensator. ">proportional</a> is set to zero</li>
<li>The <a class="el" href="charger__discharger_8h.html#a1174af01b8a329a6d465ea6e0951b3e5" title="Integral component of PI compensator. ">integral</a> is set to zero</li>
<li>The system is set in CV mode by clearing the <a class="el" href="charger__discharger_8h.html#aa14de202054f8be3764087df08c27eda" title="CC / CV selector. CC:  cmode = 1 . CV:  cmode = 0  ">cmode</a> variable</li>
<li>The proportional constant, <a class="el" href="charger__discharger_8h.html#a1f7add0f84d583bc2eceb290d6c4cc06" title="Proportional compesator gain. ">kp</a> is set to <a class="el" href="charger__discharger_8h.html#a31ae8362bae13f23cc6b521a7499a5ee" title="Proportional constant for CV mode. ">CV_kp</a> <br />
</li>
<li>The integral constant, <a class="el" href="charger__discharger_8h.html#a050993b7ca6c97e62c1020017f716b91" title="Integral compesator gain. ">ki</a> is set to <a class="el" href="charger__discharger_8h.html#a57181200f8247c552f8d9751003d77c6" title="Integral constant for CV mode. ">CV_ki</a> </li>
</ul>

</div>
</div>
<a id="a4f05187afaedd0cd35e9137eaf557ef8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f05187afaedd0cd35e9137eaf557ef8">&#9670;&nbsp;</a></span>control_loop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void control_loop </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is the PI control loop. </p>
<p>If <a class="el" href="charger__discharger_8h.html#aa14de202054f8be3764087df08c27eda" title="CC / CV selector. CC:  cmode = 1 . CV:  cmode = 0  ">cmode</a> is cleared then</p>
<ul>
<li>The <a class="el" href="charger__discharger_8c.html#a35df161adff36e572d40326f07d85d2b" title="This function defines the PI controller. ">pid()</a> function is called with <code>feedback</code> = <a class="el" href="charger__discharger_8h.html#a48d9522e58fa05906c6dba23e5745a72" title="Last voltage ADC measurement. ">v</a> and <code>setpoint</code> = <a class="el" href="charger__discharger_8h.html#a12a556ee5b6e008717e9b6b8916c36a4" title="Voltage setpoint. Initialized as 0. ">vref</a></li>
</ul>
<p>Else,</p>
<ul>
<li>The <a class="el" href="charger__discharger_8c.html#a35df161adff36e572d40326f07d85d2b" title="This function defines the PI controller. ">pid()</a> function is called with <code>feedback</code> = <a class="el" href="charger__discharger_8h.html#a58e739b7bdf8275493686ae76e3705c3" title="Last current ADC measurement. ">i</a> and <code>setpoint</code> = <a class="el" href="charger__discharger_8h.html#ab6bab6490e9e38ab60181b5cda64c53b" title="Current setpoint. Initialized as 0. ">iref</a></li>
</ul>
<p>The duty cycle is set by calling the <a class="el" href="charger__discharger_8c.html#a95853552054d1c99e8765eca54abb930" title="This function sets the desired duty cycle. ">set_DC()</a> function </p>

</div>
</div>
<a id="a116216d02b45c1207161f503bf20adbc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a116216d02b45c1207161f503bf20adbc">&#9670;&nbsp;</a></span>converter_settings()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void converter_settings </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to set the configurations of the converter. </p>
<ul>
<li>The proportional constant, <a class="el" href="charger__discharger_8h.html#a1f7add0f84d583bc2eceb290d6c4cc06" title="Proportional compesator gain. ">kp</a> is set to <a class="el" href="charger__discharger_8h.html#a07e4b1149c8a3d5d22e1d62cf1ac21a8" title="Proportional constant for CC mode. ">CC_kp</a></li>
<li>The proportional constant, <a class="el" href="charger__discharger_8h.html#a1f7add0f84d583bc2eceb290d6c4cc06" title="Proportional compesator gain. ">kp</a> is set to <a class="el" href="charger__discharger_8h.html#a07e4b1149c8a3d5d22e1d62cf1ac21a8" title="Proportional constant for CC mode. ">CC_kp</a></li>
<li>Start in constant current mode by setting. <a class="el" href="charger__discharger_8h.html#aa14de202054f8be3764087df08c27eda" title="CC / CV selector. CC:  cmode = 1 . CV:  cmode = 0  ">cmode</a></li>
<li>The <a class="el" href="charger__discharger_8h.html#a1174af01b8a329a6d465ea6e0951b3e5" title="Integral component of PI compensator. ">integral</a> component of the compensator is set to zero.*/</li>
<li>Average capacity, #q_prom is set to zero.*/</li>
<li>Maximum averaged voltage, <a class="el" href="charger__discharger_8h.html#aeb4eb9ad2dc148d828a7f6e270aa0f09" title="Maximum recorded average voltage. ">vmax</a> is set to zero.*/</li>
<li>Clear <a class="el" href="charger__discharger_8h.html#a639c6c3902af09dac255279f04f0db89" title="Current buffer to send to the terminal usign log_control() ">ip_buff</a></li>
<li>Clear <a class="el" href="charger__discharger_8h.html#aa9b685d478b266b9155c576dd4da0dc0" title="Voltage buffer to send to the terminal usign log_control() ">vp_buff</a></li>
<li>Clear <a class="el" href="charger__discharger_8h.html#a9f437b35570f9f0fd44ec4ba168ac115" title="Temperature buffer to send to the terminal usign (). ">tp_buff</a></li>
<li>Clear <a class="el" href="charger__discharger_8h.html#af7319d00b273407ffe5f28b29e97a1c7" title="Capacity buffer to send to the terminal usign log_control() . ">qp_buff</a></li>
<li>The initial <b> duty cycle </b> of the PWM is set to <a class="el" href="charger__discharger_8h.html#aa845f7768f44631f4b54b9cde4dc2b2f" title="Initial duty cycle, set around 0.1. ">DC_START</a></li>
<li>The <a class="el" href="charger__discharger_8c.html#a95853552054d1c99e8765eca54abb930" title="This function sets the desired duty cycle. ">set_DC()</a> function is called</li>
<li>The <a class="el" href="charger__discharger_8c.html#a1d26bd6e1261ba0d776c492ad35593f4" title="This function activate the desired relay in the switcher board according to the value of cell_count...">Cell_ON()</a> function is called</li>
</ul>
<p>If the current state is <code>POSTCHARGE</code> or <code>CHARGE</code> </p>
<ul>
<li>The current setpoint, <a class="el" href="charger__discharger_8h.html#ab6bab6490e9e38ab60181b5cda64c53b" title="Current setpoint. Initialized as 0. ">iref</a> is defined as <a class="el" href="charger__discharger_8h.html#a9f7bc04927df757f9416084659beb22b" title="Charging current in mA. ">i_char</a></li>
<li>Charging #timeout is set to 10% more <b>only_for}_NIMH</b> </li>
<li>The charge/discharge relay, <code>RA0</code> is cleared, charge position</li>
</ul>
<p>If the current state is <code>PREDISCHARGE</code> or <code>DISCHARGE</code> </p>
<ul>
<li>The current setpoint, <a class="el" href="charger__discharger_8h.html#ab6bab6490e9e38ab60181b5cda64c53b" title="Current setpoint. Initialized as 0. ">iref</a> is defined as <a class="el" href="charger__discharger_8h.html#abee5b899e99e0165d63f1e4a3b72a9dd" title="Discharging current in mA. ">i_disc</a></li>
<li>The charge/discharge relay, <code>RA0</code> is set, discharge position</li>
</ul>
<p>If the current state is <a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677a031d03f2aee61a88f34151e0b532df5b" title="&quot;Charged state DC resistance&quot; state, defined by function fDC_res() ">CS_DC_res</a>, <a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677a5d64f3582250fabf9443c93ca77ecf9c" title="&quot;Discharged state DC resistance&quot; state, defined by function fDC_res() ">DS_DC_res</a> or <a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677a68bd1d9b6b5d032caefff13585f9d22b" title="&quot;Postcharged state DC resistance&quot; state, defined by function fDC_res() ">PS_DC_res</a></p>
<ul>
<li>The current setpoint, <a class="el" href="charger__discharger_8h.html#ab6bab6490e9e38ab60181b5cda64c53b" title="Current setpoint. Initialized as 0. ">iref</a> is defined as <code> capacity / 5 </code></li>
<li>The <a class="el" href="charger__discharger_8h.html#a84cf4389d019b53039c0c1ce35691335" title="Counter for DC resistance. Initialized as DC_RES_SECS. ">dc_res_count</a> is set to <a class="el" href="charger__discharger_8h.html#aa2683ee4bd7cd9cdab8006368da6df09" title="How many seconds the DC resistance process takes. ">DC_RES_SECS</a></li>
<li>The charge/discharge relay, <code>RA0</code> is set, discharge position <br />
 The timing counter <a class="el" href="charger__discharger_8h.html#a6a9e89d63eb610dfe238b0a840979421" title="Counter that should be cleared every second. Initialized as COUNTER. ">count</a> will be intialized to zero, to start a full control loop cycle </li>
</ul>

</div>
</div>
<a id="a4389e5f80fbf28788f2f648f26d93fce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4389e5f80fbf28788f2f648f26d93fce">&#9670;&nbsp;</a></span>display_value()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void display_value </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>value</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function convert a number to string and then send it using UART. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">value</td><td>integer to be send </td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>Define <code>buffer</code> to used it for store character storage</li>
<li>Convert <code>value</code> into a string and store it in <code>buffer</code> </li>
<li>Send <code>buffer</code> using <a class="el" href="charger__discharger_8c.html#ac27ccd7f2eb1f5e96bb091338acc1e7f" title="This function send a string using UART. ">UART_send_string()</a> </li>
</ul>

</div>
</div>
<a id="a0c4e2b572b4dd0ba38a90c7721edf3d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c4e2b572b4dd0ba38a90c7721edf3d8">&#9670;&nbsp;</a></span>fCHARGE()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fCHARGE </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function define the IDLE state of the state machine. </p>
<ul>
<li>Activate the logging by calling <a class="el" href="charger__discharger_8h.html#a4d26e5ca6078be961b6b42719ebca269" title="Turn OFF logging in the terminal. ">LOG_ON()</a> macro</li>
<li>Activate control loop by setting <a class="el" href="charger__discharger_8h.html#a0cc5d179fc4afa584f15244b35b01521" title="Turn controller ON(1) or OFF(0). Initialized as 0. ">conv</a></li>
</ul>
<p>If <a class="el" href="charger__discharger_8h.html#aa8a45b535ece3b14958359be03fa74b0" title="Last one-second-average of v . Initialized as 0. ">vprom</a> is below 0.9V</p>
<ul>
<li>Go to <a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677ab7f3a434cd7c576917ad58613673c571" title="&quot;Fault&quot; state, defined by function fFAULT() ">FAULT</a> state</li>
<li>Send a warning message</li>
</ul>
<p>If the <a class="el" href="charger__discharger_8h.html#ab12828525693568ae9c217805bea1ef9" title="Used with store the value of the states enum. Initialized as STANDBY. ">state</a> is <a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677aea7debd6c1f7cf2d27b8774acac4109f" title="&quot;Charge&quot; state, defined by function fCHARGE() ">CHARGE</a></p>
<p>If the chemistry is Ni-MH</p>
<ul>
<li>If <a class="el" href="charger__discharger_8h.html#aa8a45b535ece3b14958359be03fa74b0" title="Last one-second-average of v . Initialized as 0. ">vprom</a> is 10mV below the maximum recorded voltage or the #timeout was reached then</li>
</ul>
<ol type="1">
<li>Set <a class="el" href="charger__discharger_8h.html#ad24a7209740a83b880691380fbe8e0e9" title="Used to store the previous state. Initialized as STANDBY. ">prev_state</a> equal to <a class="el" href="charger__discharger_8h.html#ab12828525693568ae9c217805bea1ef9" title="Used with store the value of the states enum. Initialized as STANDBY. ">state</a></li>
<li>If <a class="el" href="charger__discharger_8h.html#aa138b263667688f0a28af01c14f90f8a" title="Four different options, look into param() for details. ">option</a> is '3' then go to #DONE state</li>
<li>Else, go to <a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677a79a322ccb4b29b85b3cab52dbccefd17" title="&quot;Wait&quot; state, defined by function fWAIT() ">WAIT</a> state <br />
<br />
</li>
<li>Set <a class="el" href="charger__discharger_8h.html#ab6565850a0af535f87ce6e6fcb0b8c76" title="Counter for waiting time between states. Initialized as WAIT_TIME. ">wait_count</a> equal to <a class="el" href="charger__discharger_8h.html#ae7676cdfa371dfdcf6fb0687737c29a6" title="Time to wait before states, set to 10 minutes. ">WAIT_TIME</a></li>
<li>Stop the converter by calling <a class="el" href="charger__discharger_8h.html#ae1cb4a0872e924cf862a97b33dd2edf0" title="Stop the converter. ">STOP_CONVERTER()</a> macro </li>
</ol>

</div>
</div>
<a id="a0b36b83531f2626d071ba3d1115ba83f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b36b83531f2626d071ba3d1115ba83f">&#9670;&nbsp;</a></span>fDC_res()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fDC_res </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function define the IDLE state of the state machine. </p>
<p>I dont like this </p>

</div>
</div>
<a id="aa309f5ae96bb5d30d1097731fc373f1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa309f5ae96bb5d30d1097731fc373f1f">&#9670;&nbsp;</a></span>fFAULT()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fFAULT </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function define the FAULT state of the state machine. </p>
<p>The function will stop the converter usign <a class="el" href="charger__discharger_8h.html#ae1cb4a0872e924cf862a97b33dd2edf0" title="Stop the converter. ">STOP_CONVERTER()</a> macro</p>
<p>The <code>state</code> will be set to <code>STANDBY</code> </p>

</div>
</div>
<a id="af14972c8bcddf306a0cc7f7f43a5e3c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af14972c8bcddf306a0cc7f7f43a5e3c1">&#9670;&nbsp;</a></span>fIDLE()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fIDLE </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function define the IDLE state of the state machine. </p>
<p>At first, the function will call the #Start_state_machine() function.</p>
<p>Then, it will call the #Converter_settings() function.</p>
<p>Then, it will enable the USART reception interrupts to give the possibility to the user to press <b>ESC</b> to cancel or <b>n</b> to go to the next cell, at any time during the testing process </p>

</div>
</div>
<a id="a6f57fe99a95d5951b37346f2e592a033"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f57fe99a95d5951b37346f2e592a033">&#9670;&nbsp;</a></span>fISDONE()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fISDONE </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is executed every time a whole test process for one cell is finished. </p>
<p>The function will check if the current cell number (<code>cell_count</code>) is smaller than the number of cells to be tested (<code>cell_max</code>)</p>
<p>If the condition is <b>TRUE</b> the counter will be incremented <br />
 And the testin process of the next cell will be started by going to the <code>IDLE</code> state </p>

</div>
</div>
<a id="a617e0199133fdef0d3a3e6a4a4c39c7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a617e0199133fdef0d3a3e6a4a4c39c7e">&#9670;&nbsp;</a></span>fSTANDBY()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fSTANDBY </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function define the <a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677ae4634ae4352b512b38c5da9dc1610ca6" title="&quot;Stand by&quot; state, defined by function fSTANDBY() ">STANDBY</a> state of the state machine. </p>
<ul>
<li>Stop the converter by calling the <a class="el" href="charger__discharger_8h.html#ae1cb4a0872e924cf862a97b33dd2edf0" title="Stop the converter. ">STOP_CONVERTER()</a> macro</li>
<li>Disable the USART reception interrupts to avoid interference with the setting of parameters in the <a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677ae4634ae4352b512b38c5da9dc1610ca6" title="&quot;Stand by&quot; state, defined by function fSTANDBY() ">STANDBY</a> state</li>
<li>Initialize <a class="el" href="charger__discharger_8h.html#aa138b263667688f0a28af01c14f90f8a" title="Four different options, look into param() for details. ">option</a> to 0</li>
<li>Initialize <a class="el" href="charger__discharger_8h.html#a00fd8f059b9286917da9abe7e3561aaa" title="Number of cells to be tested. Initialized as 0. ">cell_max</a> to 0</li>
<li>Initialize <a class="el" href="charger__discharger_8h.html#a2f582152bcd11169abaab8dfb2e0ae2a" title="Cell counter from &#39;1&#39; to &#39;4&#39;. Initialized as &#39;1&#39;. ">cell_count</a> to '1'</li>
<li>Print message: <code> &mdash;Parameter definition for charger and discharger&mdash; </code></li>
</ul>
<p>If <a class="el" href="charger__discharger_8h.html#a28a6dfc4597c4f82e81b47ca06486504" title="Set this definition to 1 and NI_MH_CHEM to 0 to set the test Li-Ion cells. ">LI_ION_CHEM</a> is set to <b>1</b> and <a class="el" href="charger__discharger_8h.html#a80362a7f4e241d7fd6bcc19d5f21ffd7" title="Set this definition to 1 and LI_ION_CHEM to 0 to set the test Ni-MH cells. ">NI_MH_CHEM</a> is set to <b>0</b>, the folowing message will be displayed:</p>
<p>If <a class="el" href="charger__discharger_8h.html#a80362a7f4e241d7fd6bcc19d5f21ffd7" title="Set this definition to 1 and LI_ION_CHEM to 0 to set the test Ni-MH cells. ">NI_MH_CHEM</a> is set to <b>1</b> and <a class="el" href="charger__discharger_8h.html#a28a6dfc4597c4f82e81b47ca06486504" title="Set this definition to 1 and NI_MH_CHEM to 0 to set the test Li-Ion cells. ">LI_ION_CHEM</a> is set to <b>0</b>, the folowing message will be displayed:</p>
<ul>
<li><code> Chemistry defined as Ni-MH </code></li>
</ul>
<p>Call the <a class="el" href="state__machine_8c.html#a54ace7ad4925a44e0b916762be282d66" title="Function to define the parameters of the testing process for both chemistries. ">param()</a> function </p>

</div>
</div>
<a id="a621fb7a48066389e0889ad9f7413f6c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a621fb7a48066389e0889ad9f7413f6c9">&#9670;&nbsp;</a></span>fWAIT()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fWAIT </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function define the IDLE state of the state machine. </p>
<p>MAYBEOK </p>

</div>
</div>
<a id="a9efe22aaead3a5e936b5df459de02eba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9efe22aaead3a5e936b5df459de02eba">&#9670;&nbsp;</a></span>initialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initialize </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to define initialize the system. </p>
<p><b>GENERAL</b> </p>
<ul>
<li>Allow change of individual WPU</li>
</ul>
<p><b>SYSTEM</b> <b>CLOCK</b> </p>
<p>PLL is always enabled because of configuration bits</p>
<ul>
<li>Set clock to 32MHz (with PLL)</li>
<li>Clock determined by FOSC&lt;2:0&gt; in Configuration Words</li>
<li>Enable PLL. According to Errata this shall not be done in the Configuration Words</li>
</ul>
<p><b>RELAY</b> <b>OUPUTS</b> </p>
<ul>
<li>Set RA0 as output. Charge/Discharge relay</li>
<li>Set RA0 as digital</li>
<li>Set RA3 as output. ON/OFF relay</li>
<li>Set RA3 as digital</li>
</ul>
<p><b>CELL</b> <b>SWITCHER</b> <b>OUPUTS</b> </p>
<p><b>TIMER0</b> for control and measuring loop</p>
<ul>
<li>Disable timer interruptions</li>
<li>Timer set to internal instruction cycle</li>
<li>Prescaler set to 128</li>
<li>Prescaler activated</li>
<li>Timer flag cleared</li>
<li>Counter set to 255 - <b>250</b> + 2 (delay for sync) = 7</li>
</ul>
<p>Timer set to 32Mhz/4/128/250 = 250Hz</p>
<p><b>PSMC/PWM</b> <b>SETTINGS</b> </p>
<p>Outputs</p>
<ul>
<li>[Temporary] Set RA4 as input to let it drive from RB3.</li>
<li>[Temporary] Disable WPU for RA4.</li>
<li>[Temporary] Disable WPU for RC0.</li>
</ul>
<p>Programmable switch mode control (PSMC)</p>
<ul>
<li>Clear PSMC1 configuration to start</li>
<li>No modulation</li>
<li>Driven by 64MHz PLL system clock</li>
<li>Set period high register to 0x01</li>
<li>Set period low register to 0xFF</li>
</ul>
<p>511 + 1 clock cycles for period that is 8us (125KHz)</p>
<p>This set the PWM with 9 bit of resolution</p>
<p>Duty cycle</p>
<p>Phase or rising event</p>
<ul>
<li>Rising event starts from the beginning</li>
<li>Rising event starts from the beginning</li>
<li>Single PWM activated in PSMC1A (RCO))</li>
<li>Active high</li>
<li>PSMC1A activated in PSMC1A (RC0)</li>
<li>Period event occurs when PSMC1TMR = PSMC1PR</li>
<li>Rising edge event occurs when PSMC1TMR = PSMC1PH</li>
<li>Falling edge event occurs when PSMC1TMR = PSMC1DC</li>
<li>Enable|Load Buffer|Dead band disabled|Single PWM</li>
<li>Set RC0 as output</li>
</ul>
<p><b>ADC</b> </p>
<p>ADC INPUTS</p>
<ul>
<li>RA3, Positive voltage reference</li>
<li>RA3 analog</li>
<li>Weak pull up Deactivated</li>
<li>RB4, current sensing input</li>
<li>RB4 analog</li>
<li>Weak pull up Deactivated</li>
<li>RB5, voltage sensing input</li>
<li>RB5 analog</li>
<li>Weak pull up Deactivated</li>
</ul>
<p>Configs</p>
<ul>
<li>12 bits result</li>
<li>Clock selected as FOSC/32</li>
<li>Connected to Vss</li>
<li>Connected to VDD, change after to Connected to Vref+ (01)</li>
<li>2's compliment result</li>
<li>Negative differential input as ADNREF</li>
<li>Turn on the ADC</li>
</ul>
<p><b>UART</b> </p>
<ul>
<li>RC6 selected as TX</li>
<li><p class="startli">RC7 selected as RX</p>
<p class="startli">Initialize SPBRG register for required baud rate and set BRGH for fast baud_rate</p>
</li>
<li>for high baud_rate</li>
<li>for 16 bits timer</li>
<li>Asynchronous</li>
<li>Enable serial port pins</li>
<li>enable transmission</li>
<li>enable reception</li>
<li>8-bit reception selected</li>
<li>8-bit reception mode selected</li>
</ul>
<p><b>INTERRUPTS</b> </p>
<ul>
<li>Activate pehierals Interrupts</li>
<li>Activate Global Interrupts</li>
<li>Disable UART reception interrupts</li>
<li>Disable UART transmision interrupts</li>
</ul>
<p>CHECK ALL!!</p>
<ul>
<li>Clear WDT by calling <code>CLRWDT()</code> </li>
<li>Call <a class="el" href="charger__discharger_8h.html#ae1cb4a0872e924cf862a97b33dd2edf0" title="Stop the converter. ">STOP_CONVERTER()</a></li>
<li>Clear Timer0 flag</li>
<li>Clear ADC result variable</li>
<li>Start in CC mode <br />
<br />
</li>
<li>CHECK!!!</li>
<li>CHECK!! </li>
</ul>

</div>
</div>
<a id="a0b8b498532d1d667c624601a3cf715bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b8b498532d1d667c624601a3cf715bc">&#9670;&nbsp;</a></span>log_control()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void log_control </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function takes care of printing the test data using the UART. </p>
<p>The code in this function is only excecuted if the <a class="el" href="charger__discharger_8h.html#a8c9205727cab72e65f536e9ef6445db0" title="Variable to indicate if the log is activated. ">log_on</a> variable is set</p>
<p>This funtion takes care of sending the logging data in pieces to avoid disturbing the control loop. This problem can be avoided with the use of interruptions for the control loop; however this was not implemented and could be considered as some future improvement</p>
<p><a class="el" href="charger__discharger_8h.html#a6a9e89d63eb610dfe238b0a840979421" title="Counter that should be cleared every second. Initialized as COUNTER. ">count</a> = 0</p>
<ul>
<li>Define <code>ip_buff</code> for storing #i_prom</li>
<li>Define <code>vp_buff</code> for storing #v_prom</li>
<li>Define <code>tp_buff</code> for storing <a class="el" href="charger__discharger_8h.html#ade869e001da18e227da4d9dbb0b616da" title="Last one-second-average of t . Initialized as 0. ">tprom</a></li>
</ul>
<p>Define <code>qp_buff</code> for storing <a class="el" href="charger__discharger_8h.html#a16200aa761421d421187ce19c33dfcd0" title="Integration of i . Initialized as 0. ">qprom</a> <code>*</code> <code>10*/</code> </p>
<p><a class="el" href="charger__discharger_8h.html#a6a9e89d63eb610dfe238b0a840979421" title="Counter that should be cleared every second. Initialized as COUNTER. ">count</a> = <a class="el" href="charger__discharger_8h.html#a7194053a42881b1b4bc8546b4c8713e9" title="Counter value, needed to obtained one second between counts. ">COUNTER</a></p>
<ul>
<li>Convert <a class="el" href="charger__discharger_8h.html#a5edffad982a0566ad01d95005474eae3" title="Minutes counter, only manually reset. ">minute</a> into a string and store it in <a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033" title="Temporary buffer used between loops of log_control() ">log_buffer</a></li>
</ul>
<p>Next cycle</p>
<ul>
<li>If <a class="el" href="charger__discharger_8h.html#a5edffad982a0566ad01d95005474eae3" title="Minutes counter, only manually reset. ">minute</a> is smaller than 10 send a '0'</li>
<li>Else, send <a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033" title="Temporary buffer used between loops of log_control() ">log_buffer</a>[0]</li>
</ul>
<p>Next cycle</p>
<ul>
<li>If <a class="el" href="charger__discharger_8h.html#a5edffad982a0566ad01d95005474eae3" title="Minutes counter, only manually reset. ">minute</a> is smaller than 10 send <a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033" title="Temporary buffer used between loops of log_control() ">log_buffer</a>[0]</li>
<li>Else, send <a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033" title="Temporary buffer used between loops of log_control() ">log_buffer</a>[1]</li>
</ul>
<p>Next cycle</p>
<ul>
<li>Send a colons character</li>
</ul>
<p>Next cycle</p>
<ul>
<li>Clear <a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033" title="Temporary buffer used between loops of log_control() ">log_buffer</a></li>
</ul>
<p>Next cycle</p>
<ul>
<li>Convert <a class="el" href="charger__discharger_8h.html#a6cf35be1947a62f134392fcb1b3c54d2" title="Seconds counter, resetted after 59 seconds. ">second</a> into a string and store it in <a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033" title="Temporary buffer used between loops of log_control() ">log_buffer</a></li>
</ul>
<p>Next cycle</p>
<ul>
<li>If <a class="el" href="charger__discharger_8h.html#a6cf35be1947a62f134392fcb1b3c54d2" title="Seconds counter, resetted after 59 seconds. ">second</a> is smaller than 10 send a '0'</li>
<li>Else, send <a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033" title="Temporary buffer used between loops of log_control() ">log_buffer</a>[0]</li>
</ul>
<p>Next cycle</p>
<ul>
<li>If <a class="el" href="charger__discharger_8h.html#a6cf35be1947a62f134392fcb1b3c54d2" title="Seconds counter, resetted after 59 seconds. ">second</a> is smaller than 10 send <a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033" title="Temporary buffer used between loops of log_control() ">log_buffer</a>[0]</li>
<li>Else, send <a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033" title="Temporary buffer used between loops of log_control() ">log_buffer</a>[1]</li>
</ul>
<p>Next cycle</p>
<ul>
<li>Send a comma character</li>
</ul>
<p>Next cycle</p>
<ul>
<li>Clear <a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033" title="Temporary buffer used between loops of log_control() ">log_buffer</a></li>
</ul>
<p>Next cycle</p>
<ul>
<li>Send a 'C'</li>
</ul>
<p>Next cycle</p>
<ul>
<li>Send a <a class="el" href="charger__discharger_8h.html#a2f582152bcd11169abaab8dfb2e0ae2a" title="Cell counter from &#39;1&#39; to &#39;4&#39;. Initialized as &#39;1&#39;. ">cell_count</a> variable</li>
</ul>
<p>Next cycle</p>
<ul>
<li>Send a comma character</li>
</ul>
<p>Next cycle</p>
<ul>
<li>Send an 'S'</li>
</ul>
<p>Next cycle</p>
<ul>
<li>Convert <a class="el" href="charger__discharger_8h.html#ab12828525693568ae9c217805bea1ef9" title="Used with store the value of the states enum. Initialized as STANDBY. ">state</a> into a string and store it in <a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033" title="Temporary buffer used between loops of log_control() ">log_buffer</a></li>
</ul>
<p>Next cycle</p>
<ul>
<li>Send <a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033" title="Temporary buffer used between loops of log_control() ">log_buffer</a>[0]</li>
</ul>
<p>Next cycle</p>
<ul>
<li>If <a class="el" href="charger__discharger_8h.html#ab12828525693568ae9c217805bea1ef9" title="Used with store the value of the states enum. Initialized as STANDBY. ">state</a> is bigger than 10, send <a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033" title="Temporary buffer used between loops of log_control() ">log_buffer</a>[0]</li>
</ul>
<p>Next cycle</p>
<ul>
<li>Send a comma character</li>
</ul>
<p>Next cycle</p>
<ul>
<li>Send a 'V'</li>
</ul>
<p>Next cycle</p>
<ul>
<li>Convert <code>vp_buff</code> into a string and store it in <a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033" title="Temporary buffer used between loops of log_control() ">log_buffer</a></li>
</ul>
<p>Next cycle</p>
<ul>
<li>Send <a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033" title="Temporary buffer used between loops of log_control() ">log_buffer</a>[0]</li>
</ul>
<p>Next cycle</p>
<ul>
<li>Send <a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033" title="Temporary buffer used between loops of log_control() ">log_buffer</a>[1]</li>
</ul>
<p>Next cycle</p>
<ul>
<li>Send <a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033" title="Temporary buffer used between loops of log_control() ">log_buffer</a>[2]</li>
</ul>
<p>Next cycle</p>
<ul>
<li>If <code>vp_buff</code> is bigger than 1000, send <a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033" title="Temporary buffer used between loops of log_control() ">log_buffer</a>[3]</li>
</ul>
<p>Next cycle</p>
<ul>
<li>Send a comma character</li>
</ul>
<p>Next cycle</p>
<ul>
<li>Clear <a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033" title="Temporary buffer used between loops of log_control() ">log_buffer</a></li>
</ul>
<p>Next cycle</p>
<ul>
<li>Send an 'I'</li>
</ul>
<p>Next cycle</p>
<ul>
<li>Convert <code>ip_buff</code> into a string and store it in <a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033" title="Temporary buffer used between loops of log_control() ">log_buffer</a></li>
</ul>
<p>Next cycle</p>
<ul>
<li>Send <a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033" title="Temporary buffer used between loops of log_control() ">log_buffer</a>[0]</li>
</ul>
<p>Next cycle</p>
<ul>
<li>Send <a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033" title="Temporary buffer used between loops of log_control() ">log_buffer</a>[1]</li>
</ul>
<p>Next cycle</p>
<ul>
<li>Send <a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033" title="Temporary buffer used between loops of log_control() ">log_buffer</a>[2]</li>
</ul>
<p>Next cycle</p>
<ul>
<li>If <code>ip_buff</code> is bigger or equal to 1000, send <a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033" title="Temporary buffer used between loops of log_control() ">log_buffer</a>[3]</li>
</ul>
<p>Next cycle</p>
<ul>
<li>Send a comma character</li>
</ul>
<p>Next cycle</p>
<ul>
<li>Clear <a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033" title="Temporary buffer used between loops of log_control() ">log_buffer</a></li>
</ul>
<p>Next cyclev</p>
<ul>
<li>Send a 'T'</li>
</ul>
<p>Next cycle</p>
<ul>
<li>Convert <code>tp_buff</code> into a string and store it in <a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033" title="Temporary buffer used between loops of log_control() ">log_buffer</a></li>
</ul>
<p>Next cycle</p>
<ul>
<li>Send <a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033" title="Temporary buffer used between loops of log_control() ">log_buffer</a>[0]</li>
</ul>
<p>Next cycle</p>
<ul>
<li>Send <a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033" title="Temporary buffer used between loops of log_control() ">log_buffer</a>[1]</li>
</ul>
<p>Next cycle</p>
<ul>
<li>Send <a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033" title="Temporary buffer used between loops of log_control() ">log_buffer</a>[1]</li>
</ul>
<p>Next cycle</p>
<p>Next cycle</p>
<ul>
<li>Send a comma character</li>
</ul>
<p>Next cycle</p>
<ul>
<li>Clear <a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033" title="Temporary buffer used between loops of log_control() ">log_buffer</a></li>
</ul>
<p>Next cycle</p>
<ul>
<li>Send a 'Q'</li>
</ul>
<p>Next cycle</p>
<ul>
<li>Convert <code>qp_buff</code> into a string and store it in <a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033" title="Temporary buffer used between loops of log_control() ">log_buffer</a></li>
</ul>
<p>Next cycle</p>
<ul>
<li>Send <a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033" title="Temporary buffer used between loops of log_control() ">log_buffer</a>[0]</li>
</ul>
<p>Next cycle</p>
<ul>
<li>If <code>qp_buff</code> is bigger or equal to 10, send <a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033" title="Temporary buffer used between loops of log_control() ">log_buffer</a>[1]</li>
</ul>
<p>Next cycle</p>
<ul>
<li>If <code>qp_buff</code> is bigger or equal to 100, send <a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033" title="Temporary buffer used between loops of log_control() ">log_buffer</a>[2]</li>
</ul>
<p>Next cycle</p>
<ul>
<li>If <code>qp_buff</code> is bigger or equal to 1000, send <a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033" title="Temporary buffer used between loops of log_control() ">log_buffer</a>[3]</li>
</ul>
<p>Next cycle</p>
<ul>
<li>If <code>qp_buff</code> is bigger or equal to 10000, send <a class="el" href="charger__discharger_8h.html#a20f2ad896b5d2be3ebe2145c7b00e033" title="Temporary buffer used between loops of log_control() ">log_buffer</a>[4]</li>
</ul>
<p>Next cycle</p>
<ul>
<li>Send a '&lt;'</li>
</ul>
<p>If <a class="el" href="charger__discharger_8h.html#a8c9205727cab72e65f536e9ef6445db0" title="Variable to indicate if the log is activated. ">log_on</a> is cleared, call <a class="el" href="charger__discharger_8h.html#a59595b0c67a8bfb8dd65e914a18b83c7" title="Reset timers. ">RESET_TIME()</a> </p>

</div>
</div>
<a id="ac441c35a0d7d01f983d6b3414944d62a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac441c35a0d7d01f983d6b3414944d62a">&#9670;&nbsp;</a></span>param()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void param </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to define the parameters of the testing process for both chemistries. </p>
<p>First, this function will declare and intialize to zero a variable called <code>input</code>, which will be used to store the input of the user.</p>
<p>Then, it will show the pre-set parameters for charging that are:</p>
<p>For Li Ion:</p>
<div class="fragment"><div class="line"><a class="code" href="charger__discharger_8h.html#a5d26458814361e1cf732df92f7dbc2d9">Li_Ion_CV</a> = 4200 mV</div><div class="line"><a class="code" href="charger__discharger_8h.html#adb28139964ea13e391208ea07372cace">Li_Ion_CAP</a> = 3250 mAh </div></div><!-- fragment --><p>For Ni_MH:</p>
<div class="fragment"><div class="line"><a class="code" href="charger__discharger_8h.html#ac8b7523ae7285838d22d268d244e3e41">Ni_MH_CV</a> = 1700 mV <span class="comment">//Just for protection for now, maybe is not necessary to show it</span></div><div class="line"><a class="code" href="charger__discharger_8h.html#a94e2a4926de4ad984b884e1ea882f06a">Ni_MH_CAP</a> = 2500 mAh</div></div><!-- fragment --><p>The <code>capacity</code> will be set to <code>Ni_MH_CAP</code>.</p>
<p>For the charging current it will print three options:</p>
<ul>
<li>1) 0.25 C</li>
<li>2) 0.5 C</li>
<li>3) 1 C</li>
</ul>
<p>The user should input the desired option.</p>
<p>After chosing the charging current, the program will assign it to <code>i_char</code> and print it.</p>
<p>Unless the user press <em>ESC</em>, in that case the program will be restarted to the <code>STANBY</code> state.</p>
<p>If the user press something different from <b>1</b>, <b>2</b>, <b>3</b> or <b>ESC</b> the program will print a warning message and wait for a valid input.</p>
<p>Variable <code>input</code> is cleared</p>
<p>Next, the program will show the end-of-charge parameters that are:</p>
<p>For Li Ion, the end-of-charge current:</p>
<div class="fragment"><div class="line"><a class="code" href="charger__discharger_8h.html#a613a15ecc1a8e85198d8c93ce546fcf6">Li_Ion_EOC_I</a> = 100 mA</div></div><!-- fragment --><p>For Ni_MH, the end-of-charge voltage drop:</p>
<div class="fragment"><div class="line"><a class="code" href="charger__discharger_8h.html#ae0f8da57c2fb3c5701f9d5fe4685bcd8">Ni_MH_EOC_DV</a> = 10 mV</div></div><!-- fragment --><p>For the discharging current it will show three options:</p>
<ul>
<li>1) 0.25 C</li>
<li>2) 0.5 C</li>
<li>3) 1 C</li>
</ul>
<p>The user should input the desired option.</p>
<p>After chosing the discharging current, the program will assign it to <code>i_disc</code> and print it.</p>
<p>Unless the user press <em>ESC</em>, in that case the program will be restarted to the <code>STANBY</code> state.</p>
<p>If the user press something different from <em>1</em>, <em>2</em>, <em>3</em> or <em>ESC</em> the program will print a warning message and wait for a valid input.</p>
<p>Varible <code>input</code> is cleared</p>
<p>Next, the program will show the end-of-discharge voltage constant that is: ((CHANGE THIS STYLE))</p>
<p>For Li Ion:</p>
<div class="fragment"><div class="line"><a class="code" href="charger__discharger_8h.html#a5b5d74511caec60eedfdfbf9fe71ce94">Li_Ion_EOD_V</a> = 3000 mV</div></div><!-- fragment --><p>For Ni_MH:</p>
<div class="fragment"><div class="line"><a class="code" href="charger__discharger_8h.html#a42b65399d5bd123d6001f5a0cf3353e1">Ni_MH_EOD_V</a> = 1000 mV</div></div><!-- fragment --><p>For the test cycle it will show four options:</p>
<ul>
<li>1) Precharge-&gt;Discharge-&gt;Charge (includes DC resistance measure after charge and after discharge).</li>
<li>2) Discharge-&gt;Charge (includes DC resistance measure after charge and after discharge).</li>
<li>3) Only Charge</li>
<li>4) Only Discharge</li>
</ul>
<p>The user should input the desired option, which will be assigned to <code>option</code> </p>
<p>After that the program will print the selected option and:</p>
<p>Unless the user press <em>ESC</em>, in that case the program will be restarted to the <code>STANBY</code> state.</p>
<p>If the user press something different from <b>1</b>, <b>2</b>, <b>3</b>, <b>4</b> or <b>ESC</b> the program will print a warning message and wait for a valid input.</p>
<p>Then, the program will ask the user how many cells he wants to test (4 cells is the maximum):</p>
<p>The user should input the desired number, which will be assigned to <code>cell_max</code> </p>
<p>After that the program will print it.</p>
<p>Unless the user press <b>ESC</b>, in that case the program will be restarted to the <code>STANBY</code> state.</p>
<p>If the user press something different from <b>1</b>, <b>2</b>, <b>3</b>, <b>4</b> or <b>ESC</b> the program will print a warning message and wait for a valid input.</p>
<p>After the user has set the number of cells the program will go to the <code>IDLE</code> state. </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="state__machine_8c.html#aab8843d66ed853494d05155924f4229e" title="This function define the IDLE state of the state machine. ">fIDLE()</a> </dd></dl>

</div>
</div>
<a id="a35df161adff36e572d40326f07d85d2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35df161adff36e572d40326f07d85d2b">&#9670;&nbsp;</a></span>pid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pid </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>feedback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>setpoint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function defines the PI controller. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">feedback</td><td>average of measured values for the control variable </td></tr>
    <tr><td class="paramname">setpoint</td><td>desire controlled output for the variable </td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>Define <code>er</code> for calculating the error</li>
<li>Define <code>pi</code> for storing the PI compesator value</li>
<li>Calculate the error by substracting the <code>feedback</code> from the <code>setpoint</code> and store it in <code>er</code> </li>
<li>Make sure error is never above <a class="el" href="charger__discharger_8h.html#aadc49366a240cc84254d58cb455dee82" title="Maximum permisible error, useful to avoid ringing. ">ERR_MAX</a></li>
<li>Make sure error is never below <a class="el" href="charger__discharger_8h.html#a5bcad3156af59109b8ac2c78c588885a" title="Minimum permisible error, useful to avoid ringing. ">ERR_MIN</a></li>
<li>Calculate <a class="el" href="charger__discharger_8h.html#ad984965db113bd0969498c826e23ab44" title="Proportional component of PI compensator. ">proportional</a> component of compensator</li>
<li>Calculate <a class="el" href="charger__discharger_8h.html#a1174af01b8a329a6d465ea6e0951b3e5" title="Integral component of PI compensator. ">integral</a> component of compensator</li>
<li>Sum them up and store in <code>pi*/</code> </li>
<li>Make sure duty cycle is never above <a class="el" href="charger__discharger_8h.html#a701d2222601b84faafa94cb1909df104" title="Maximum possible duty cycle, set around 0.8. ">DC_MAX</a></li>
<li>Make sure duty cycle is never below <a class="el" href="charger__discharger_8h.html#a998e4507851dde706a60a5b475eb27ca" title="Minimum possible duty cycle, set around 0.05. ">DC_MIN</a></li>
<li>Store the new value of the duty cycle with operation<div class="fragment"><div class="line"><a class="code" href="charger__discharger_8h.html#a7feaae074885a9d2f57a75e0809ee4ba">dc</a> = <a class="code" href="charger__discharger_8h.html#a7feaae074885a9d2f57a75e0809ee4ba">dc</a> + pi </div></div><!-- fragment --> </li>
</ul>

</div>
</div>
<a id="a1402bbcb4580b6798483c7821e6106d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1402bbcb4580b6798483c7821e6106d2">&#9670;&nbsp;</a></span>read_ADC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_ADC </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function read the ADC and store the data in the coresponding variables. </p>
<p>Define <code>opr</code> to store the operations inside the function</p>
<p>Select the <a class="el" href="charger__discharger_8h.html#a420d619b855e71d5e8d4c26e2d0a0461" title="Definition of ADC channel for voltage measurements. AN13(RB5) ">V_CHAN</a> channel usign <a class="el" href="charger__discharger_8h.html#a450cfb6cea2848f3c6459ed5c0df9eef" title="Set the ADC channel to x and wait for 5 microseconds. ">AD_SET_CHAN(x)</a></p>
<p>Make the conversion by calling <a class="el" href="charger__discharger_8h.html#a57f8ee4c55d0b9230535c602e01dbbdc" title="Start the conversion and wait until it is finished. ">AD_CONVERT()</a></p>
<p>Store the result in <a class="el" href="charger__discharger_8h.html#a02303eca810feb8092be2ff939a714c3" title="Result of an ADC measurement. ">ad_res</a> with <a class="el" href="charger__discharger_8h.html#a049dca77d5e2be6f3780ce6a632a5ef3" title="Store conversion result in ad_res. ">AD_RESULT()</a></p>
<p>Apply the operation</p><div class="fragment"><div class="line">opr = <a class="code" href="charger__discharger_8h.html#a02303eca810feb8092be2ff939a714c3">ad_res</a> * [(R1+R2)/(R1)] * [(Vref)/(2^12)] = <a class="code" href="charger__discharger_8h.html#a02303eca810feb8092be2ff939a714c3">ad_res</a> * (1051/1000) * (5014/4096) </div></div><!-- fragment --><p>Make <a class="el" href="charger__discharger_8h.html#a48d9522e58fa05906c6dba23e5745a72" title="Last voltage ADC measurement. ">v</a> equal to <code>opr</code> </p>
<p>Select the <a class="el" href="charger__discharger_8h.html#a72da0b033e023b574cca6ab663e25fca" title="Definition of ADC channel for current measurements. AN11(RB4) ">I_CHAN</a> channel usign <a class="el" href="charger__discharger_8h.html#a450cfb6cea2848f3c6459ed5c0df9eef" title="Set the ADC channel to x and wait for 5 microseconds. ">AD_SET_CHAN(x)</a></p>
<p>Make the conversion by calling <a class="el" href="charger__discharger_8h.html#a57f8ee4c55d0b9230535c602e01dbbdc" title="Start the conversion and wait until it is finished. ">AD_CONVERT()</a></p>
<p>Store the result in <a class="el" href="charger__discharger_8h.html#a02303eca810feb8092be2ff939a714c3" title="Result of an ADC measurement. ">ad_res</a> with <a class="el" href="charger__discharger_8h.html#a049dca77d5e2be6f3780ce6a632a5ef3" title="Store conversion result in ad_res. ">AD_RESULT()</a></p>
<p>Apply the operation</p><div class="fragment"><div class="line">opr = [(Vref)/(2^12)] * <a class="code" href="charger__discharger_8h.html#a02303eca810feb8092be2ff939a714c3">ad_res</a> </div></div><!-- fragment --><p>Apply the operation</p><div class="fragment"><div class="line">opr = opr - 2525 </div></div><!-- fragment --><p>If the <a class="el" href="charger__discharger_8h.html#ab12828525693568ae9c217805bea1ef9" title="Used with store the value of the states enum. Initialized as STANDBY. ">state</a> is <a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677aea7debd6c1f7cf2d27b8774acac4109f" title="&quot;Charge&quot; state, defined by function fCHARGE() ">CHARGE</a> or <a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677a90827714b4165a402681b4ce4874e5f0" title="&quot;Postcharge&quot; state, defined by function fCHARGE() ">POSTCHARGE</a> change the sign of the result</p>
<p>Apply the operation</p><div class="fragment"><div class="line">opr = opr * 2.5 </div></div><!-- fragment --><p> which is the sensitivity of the ACS723LL</p>
<p>Select the <a class="el" href="charger__discharger_8h.html#a10ddb4ca8b21ecdf02ab19d67cb9142c" title="Definition of ADC channel for temperature measurements. AN12(RB0) ">T_CHAN</a> channel usign <a class="el" href="charger__discharger_8h.html#a450cfb6cea2848f3c6459ed5c0df9eef" title="Set the ADC channel to x and wait for 5 microseconds. ">AD_SET_CHAN(x)</a></p>
<p>Make the conversion by calling <a class="el" href="charger__discharger_8h.html#a57f8ee4c55d0b9230535c602e01dbbdc" title="Start the conversion and wait until it is finished. ">AD_CONVERT()</a></p>
<p>Store the result in <a class="el" href="charger__discharger_8h.html#a02303eca810feb8092be2ff939a714c3" title="Result of an ADC measurement. ">ad_res</a> with <a class="el" href="charger__discharger_8h.html#a049dca77d5e2be6f3780ce6a632a5ef3" title="Store conversion result in ad_res. ">AD_RESULT()</a></p>
<p>Apply the operation</p><div class="fragment"><div class="line">opr = [(Vref)/(2^12)] * <a class="code" href="charger__discharger_8h.html#a02303eca810feb8092be2ff939a714c3">ad_res</a> </div></div><!-- fragment --><p>Apply the operation</p><div class="fragment"><div class="line">opr = 1866.3 - opr </div></div><!-- fragment --><p>. Sensor STLM20 Datasheet p.6</p>
<p>Apply the operation</p><div class="fragment"><div class="line"><a class="code" href="charger__discharger_8h.html#afea36502e9d227ff62c5fb2719a246f2">t</a> = opr/1.169 </div></div><!-- fragment --><p>. Sensor STLM20 Datasheet p.6 </p>

</div>
</div>
<a id="a93f3630c962d9bcafd71e4c4a03547c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93f3630c962d9bcafd71e4c4a03547c1">&#9670;&nbsp;</a></span>set_DC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_DC </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function sets the desired duty cycle. </p>
<p>This function can set the duty cycle from 0x0 to 0x1FF</p>
<ul>
<li>Lower 8 bits of <a class="el" href="charger__discharger_8h.html#a7feaae074885a9d2f57a75e0809ee4ba" title="Duty cycle. ">dc</a> are stored in <code>PSMC1DCL</code> </li>
<li>Higher 1 bit of <a class="el" href="charger__discharger_8h.html#a7feaae074885a9d2f57a75e0809ee4ba" title="Duty cycle. ">dc</a> are stored in <code>PSMC1DCH</code> </li>
<li>Set the load register. This will load all the setting as once*/ </li>
</ul>

</div>
</div>
<a id="aa37d23c2482420861e3f4580cfbbdb2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa37d23c2482420861e3f4580cfbbdb2a">&#9670;&nbsp;</a></span>start_state_machine()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void start_state_machine </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to start the state machine. </p>
<p>First,</p>
<p>Check the option (CHANGE)</p>
<blockquote class="doxtable">
<p>if  is equal to <b>1</b> it will set the <code>state</code> as <code>PREDISCHARGE</code> </p>
</blockquote>
<blockquote class="doxtable">
<p>if  is equal to <b>2</b> it will set the <code>state</code> as <code>CHARGE</code> </p>
</blockquote>
<blockquote class="doxtable">
<p>if  is equal to <b>3</b> it will set the <code>state</code> as <code>CHARGE</code> </p>
</blockquote>
<blockquote class="doxtable">
<p>if  is equal to <b>4</b> it will set the <code>state</code> as <code>DISCHARGE</code> </p>
</blockquote>
<p>First, this function will declare and initialized to zero a variable called <code>start</code>, which will be used to store the input of the user.</p>
<p>If the current cell is the first (<code>cell_count</code>) , it will ask for user intervention to start.</p>
<p>It will prompt the user to press <b>s</b>.</p>
<p>`The key pressed by the user will be assigned to <code>start</code>.</p>
<p>If the user press <b>s</b>, the program will start.</p>
<p>The user also can press <b>ESC</b> and the program will be restarted to the <code>STANBY</code> state.</p>
<p>If the user press something different from <b>s</b>, or <b>ESC</b> the program will print a warning message and wait for a valid input.</p>
<p>If the current cell is <b>not</b> <b>'1'</b> the program will start without the user intervention.</p>
<p>Before starting, the program will print the following:</p>
<p>Starting...</p>
<p>Cell {1,2,3 or 4} </p>

</div>
</div>
<a id="a5b7665498c6c3419b3a6d53d4d2e25d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b7665498c6c3419b3a6d53d4d2e25d9">&#9670;&nbsp;</a></span>state_machine()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void state_machine </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function contain the transition definition for the states of the machine. </p>
<p>The <a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677ae4634ae4352b512b38c5da9dc1610ca6" title="&quot;Stand by&quot; state, defined by function fSTANDBY() ">STANDBY</a> state goes to the <a class="el" href="state__machine_8c.html#a615d15018432f32225d7680126353f7b" title="This function define the STANDBY state of the state machine. ">fSTANDBY()</a> function.</p>
<p>The <a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677afd6a0e4343048b10646dd2976cc5ad18" title="&quot;Idle&quot; state, defined by function fIDLE() ">IDLE</a> state goes to the <a class="el" href="state__machine_8c.html#aab8843d66ed853494d05155924f4229e" title="This function define the IDLE state of the state machine. ">fIDLE()</a> function.</p>
<p>The <a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677a95c89aa15e7cbe4ca2a03d955a4b067c" title="&quot;Predischarge&quot; state, defined by function fDISCHARGE() ">PREDISCHARGE</a> and <a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677adfece03792e81dc232ae4f15fee2a423" title="&quot;Discharge&quot; state, defined by function fDISCHARGE() ">DISCHARGE</a> states go to the <a class="el" href="state__machine_8c.html#a472415d54e3ef78c66a3f751e4eec24c" title="This function define the IDLE state of the state machine. ">fDISCHARGE()</a> function.</p>
<p>And the <a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677a90827714b4165a402681b4ce4874e5f0" title="&quot;Postcharge&quot; state, defined by function fCHARGE() ">POSTCHARGE</a> and <a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677aea7debd6c1f7cf2d27b8774acac4109f" title="&quot;Charge&quot; state, defined by function fCHARGE() ">CHARGE</a> states go to the <a class="el" href="state__machine_8c.html#a2f63169934c3ee15942c859a2619e78e" title="This function define the IDLE state of the state machine. ">fCHARGE()</a> function.</p>
<p>The <a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677a031d03f2aee61a88f34151e0b532df5b" title="&quot;Charged state DC resistance&quot; state, defined by function fDC_res() ">CS_DC_res</a> , <a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677a5d64f3582250fabf9443c93ca77ecf9c" title="&quot;Discharged state DC resistance&quot; state, defined by function fDC_res() ">DS_DC_res</a> and <a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677a68bd1d9b6b5d032caefff13585f9d22b" title="&quot;Postcharged state DC resistance&quot; state, defined by function fDC_res() ">PS_DC_res</a> states go to the <a class="el" href="state__machine_8c.html#abfbd54f51445d45b916ee44c9c1d24ae" title="This function define the IDLE state of the state machine. ">fDC_res()</a> function.</p>
<p>The <a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677a79a322ccb4b29b85b3cab52dbccefd17" title="&quot;Wait&quot; state, defined by function fWAIT() ">WAIT</a> state goes to the <a class="el" href="state__machine_8c.html#a921708424dee13fb5c6f6f1029723cea" title="This function define the IDLE state of the state machine. ">fWAIT()</a> function.</p>
<p>The <a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677a2df4f4d04ec310a30dd8eaac64f883a2" title="&quot;Is done&quot; state, defined by function fISDONE() ">ISDONE</a> state goes to the <a class="el" href="state__machine_8c.html#a7d80f4f910216189739bef97a1122ccb" title="This function is executed every time a whole test process for one cell is finished. ">fISDONE()</a> function.</p>
<p>The <a class="el" href="charger__discharger_8h.html#aa19be6305a5a4485e1e70de70ed7d677ab7f3a434cd7c576917ad58613673c571" title="&quot;Fault&quot; state, defined by function fFAULT() ">FAULT</a> state goes to the <a class="el" href="state__machine_8c.html#a357568e00e8e69fdae90ec29d83c8f35" title="This function define the FAULT state of the state machine. ">fFAULT()</a> function. </p>

</div>
</div>
<a id="ad2a34e3f615b83a0c9d721b76899b2a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2a34e3f615b83a0c9d721b76899b2a4">&#9670;&nbsp;</a></span>timing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void timing </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function control the timing. </p>
<p>If <a class="el" href="charger__discharger_8h.html#a6a9e89d63eb610dfe238b0a840979421" title="Counter that should be cleared every second. Initialized as COUNTER. ">count</a> is other than zero, then</p>
<ul>
<li>Decrease it</li>
</ul>
<p>Else,</p>
<ul>
<li>Make <a class="el" href="charger__discharger_8h.html#a6a9e89d63eb610dfe238b0a840979421" title="Counter that should be cleared every second. Initialized as COUNTER. ">count</a> equal to <a class="el" href="charger__discharger_8h.html#a7194053a42881b1b4bc8546b4c8713e9" title="Counter value, needed to obtained one second between counts. ">COUNTER</a></li>
<li>If <a class="el" href="charger__discharger_8h.html#a6cf35be1947a62f134392fcb1b3c54d2" title="Seconds counter, resetted after 59 seconds. ">second</a> is smaller than 59 then increase it</li>
<li>Else, make <a class="el" href="charger__discharger_8h.html#a6cf35be1947a62f134392fcb1b3c54d2" title="Seconds counter, resetted after 59 seconds. ">second</a> zero and increase <a class="el" href="charger__discharger_8h.html#a5edffad982a0566ad01d95005474eae3" title="Minutes counter, only manually reset. ">minute</a> </li>
</ul>

</div>
</div>
<a id="ae033bb8a9289af391aef3cc3bd57a0e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae033bb8a9289af391aef3cc3bd57a0e9">&#9670;&nbsp;</a></span>UART_get_char()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char UART_get_char </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function receive one byte of data from UART. </p>
<dl class="section return"><dt>Returns</dt><dd>RC1REG reception register </dd></dl>
<p>If there is error</p>
<ul>
<li>Clear the error</li>
<li>Restart</li>
</ul>
<p>Hold the program until the reception buffer is free <br />
 Receive the value and return it </p>

</div>
</div>
<a id="a4bcf31185383adefc22f2209541c9991"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bcf31185383adefc22f2209541c9991">&#9670;&nbsp;</a></span>UART_interrupt_enable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void UART_interrupt_enable </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function activate the UART reception interruption. </p>
<ul>
<li>Define the variable <code>clear_buffer</code>, used to empty the UART buffer</li>
<li>Clear the reception buffer and store it in <code>clear_buffer</code> </li>
<li>Enable reception interrupts </li>
</ul>

</div>
</div>
<a id="abf92d1a230db7234bdf5119716a0cf5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf92d1a230db7234bdf5119716a0cf5f">&#9670;&nbsp;</a></span>UART_send_char()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void UART_send_char </td>
          <td>(</td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>bt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function send one byte of data to UART. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bt</td><td>character to be send </td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>Hold the program until the transmission buffer is free</li>
<li>Load the transmission buffer with <code>bt</code> </li>
</ul>

</div>
</div>
<a id="ac27ccd7f2eb1f5e96bb091338acc1e7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac27ccd7f2eb1f5e96bb091338acc1e7f">&#9670;&nbsp;</a></span>UART_send_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void UART_send_string </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>st_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function send a string using UART. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">st_pt</td><td>pointer to string to be send </td></tr>
  </table>
  </dd>
</dl>
<p>While there is a byte to send</p>
<ul>
<li>Send it usign <a class="el" href="charger__discharger_8c.html#abf92d1a230db7234bdf5119716a0cf5f" title="This function send one byte of data to UART. ">UART_send_char()</a> and then increase the pointer possition </li>
</ul>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a6a9e89d63eb610dfe238b0a840979421"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a9e89d63eb610dfe238b0a840979421">&#9670;&nbsp;</a></span>count</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned count = <a class="el" href="charger__discharger_8h.html#a7194053a42881b1b4bc8546b4c8713e9">COUNTER</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Counter that should be cleared every second. Initialized as <a class="el" href="charger__discharger_8h.html#a7194053a42881b1b4bc8546b4c8713e9" title="Counter value, needed to obtained one second between counts. ">COUNTER</a>. </p>
<p>Every control loop cycle this counter will be decreased. This variable is used to calculate the averages and to trigger all the events that are done every second. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
